[0m11:42:45.285765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDDF36D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDDF36C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDDF37C10>]}


============================== 11:42:45.290776 | 464d49c1-ceb6-4a23-b080-a9cf68051772 ==============================
[0m11:42:45.290776 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:42:45.291778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:42:45.302268 [info ] [MainThread]: dbt version: 1.7.11
[0m11:42:45.302268 [info ] [MainThread]: python version: 3.11.5
[0m11:42:45.303775 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m11:42:45.304784 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m11:42:45.309346 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m11:42:45.313249 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m11:42:45.314243 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m11:42:45.401135 [info ] [MainThread]: Configuration:
[0m11:42:45.402137 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:42:45.403653 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:42:45.404673 [info ] [MainThread]: Required dependencies:
[0m11:42:45.405664 [debug] [MainThread]: Executing "git --help"
[0m11:42:45.447745 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:42:45.448820 [debug] [MainThread]: STDERR: "b''"
[0m11:42:45.449750 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:42:45.450746 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:42:45.451744 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:42:45.452742 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'test_project_dbt'


[0m11:42:45.454747 [debug] [MainThread]: Command `dbt debug` failed at 11:42:45.454747 after 0.24 seconds
[0m11:42:45.455751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD71B1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDCCD1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD7498610>]}
[0m11:42:45.455751 [debug] [MainThread]: Flushing usage events
[0m11:43:50.653987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AFB0EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AF5B8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163AFACACD0>]}


============================== 11:43:50.658074 | e339763b-cdfa-47fa-bb1a-ad330303c85f ==============================
[0m11:43:50.658074 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:43:50.659987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:43:50.663069 [info ] [MainThread]: Setting up your profile.
[0m11:44:40.226733 [info ] [MainThread]: Profile test_project_dbt written to C:\Users\Shai\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m11:44:40.229734 [debug] [MainThread]: Command `dbt init` succeeded at 11:44:40.228735 after 49.63 seconds
[0m11:44:40.230736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163A8D01750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163A8D42F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163A8D423D0>]}
[0m11:44:40.230736 [debug] [MainThread]: Flushing usage events
[0m11:44:53.814188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BAE5F8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BAE5FB610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BAE5F9190>]}


============================== 11:44:53.818207 | 89484f68-8756-464b-a612-3991aea24bab ==============================
[0m11:44:53.818207 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:44:53.819188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:53.820188 [info ] [MainThread]: dbt version: 1.7.11
[0m11:44:53.820477 [info ] [MainThread]: python version: 3.11.5
[0m11:44:53.821486 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m11:44:53.821486 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m11:44:53.910042 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m11:44:53.912043 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m11:44:53.913043 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m11:44:53.915042 [info ] [MainThread]: adapter type: postgres
[0m11:44:53.916044 [info ] [MainThread]: adapter version: 1.7.11
[0m11:44:54.005686 [info ] [MainThread]: Configuration:
[0m11:44:54.007693 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:44:54.007693 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:44:54.008692 [info ] [MainThread]: Required dependencies:
[0m11:44:54.009692 [debug] [MainThread]: Executing "git --help"
[0m11:44:54.051427 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:44:54.052422 [debug] [MainThread]: STDERR: "b''"
[0m11:44:54.052422 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:44:54.053423 [info ] [MainThread]: Connection:
[0m11:44:54.054422 [info ] [MainThread]:   host: aws-adw.czmo6y6u8ehp.ap-southeast-1.rds.amazonaws.com
[0m11:44:54.055422 [info ] [MainThread]:   port: 5432
[0m11:44:54.056484 [info ] [MainThread]:   user: postgres
[0m11:44:54.057477 [info ] [MainThread]:   database: adventureworks2022
[0m11:44:54.058480 [info ] [MainThread]:   schema: dbt
[0m11:44:54.059480 [info ] [MainThread]:   connect_timeout: 10
[0m11:44:54.059480 [info ] [MainThread]:   role: None
[0m11:44:54.060723 [info ] [MainThread]:   search_path: None
[0m11:44:54.061740 [info ] [MainThread]:   keepalives_idle: 0
[0m11:44:54.061740 [info ] [MainThread]:   sslmode: None
[0m11:44:54.062748 [info ] [MainThread]:   sslcert: None
[0m11:44:54.063748 [info ] [MainThread]:   sslkey: None
[0m11:44:54.064749 [info ] [MainThread]:   sslrootcert: None
[0m11:44:54.064749 [info ] [MainThread]:   application_name: dbt
[0m11:44:54.066256 [info ] [MainThread]:   retries: 1
[0m11:44:54.069274 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:44:54.070266 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:44:54.070266 [debug] [MainThread]: Using postgres connection "debug"
[0m11:44:54.071772 [debug] [MainThread]: On debug: select 1 as id
[0m11:44:54.072779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:54.843677 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m11:44:54.844678 [debug] [MainThread]: On debug: Close
[0m11:44:54.845676 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:44:54.845676 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:44:54.848278 [debug] [MainThread]: Command `dbt debug` succeeded at 11:44:54.847183 after 1.11 seconds
[0m11:44:54.848278 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:44:54.849289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BA78D1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BAE0F4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BAE0F4510>]}
[0m11:44:54.849289 [debug] [MainThread]: Flushing usage events
[0m11:45:50.257990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022285500DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222854F0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222854F3990>]}


============================== 11:45:50.262184 | e211c58e-d3d5-4fae-a148-7efd7eb30f93 ==============================
[0m11:45:50.262184 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:45:50.263186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:50.267402 [info ] [MainThread]: Setting up your profile.
[0m11:46:32.911217 [debug] [MainThread]: Command `dbt init` succeeded at 11:46:32.911217 after 42.72 seconds
[0m11:46:32.912218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222FE701750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222854C9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022284912450>]}
[0m11:46:32.912218 [debug] [MainThread]: Flushing usage events
[0m11:46:57.072157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF38B8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF38BABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF38BA110>]}


============================== 11:46:57.076667 | baf5fd43-d284-4519-bbfd-4ece6642f7ae ==============================
[0m11:46:57.076667 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:46:57.077667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt init dbt_etl_adw', 'send_anonymous_usage_stats': 'True'}
[0m11:46:57.081180 [info ] [MainThread]: Setting up your profile.
[0m11:47:14.868046 [debug] [MainThread]: Command `dbt init` succeeded at 11:47:14.868046 after 17.89 seconds
[0m11:47:14.869044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EECAF1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EECB33090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF2D17E90>]}
[0m11:47:14.870896 [debug] [MainThread]: Flushing usage events
[0m11:47:23.397677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013167C58350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131677447D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013167C58890>]}


============================== 11:47:23.401691 | a64c7d3b-82be-4b61-b188-ccbae9f5b9a1 ==============================
[0m11:47:23.401691 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:47:23.403694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:47:23.404692 [info ] [MainThread]: dbt version: 1.7.11
[0m11:47:23.405696 [info ] [MainThread]: python version: 3.11.5
[0m11:47:23.405696 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m11:47:23.406694 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m11:47:23.498553 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m11:47:23.499504 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m11:47:23.500576 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m11:47:23.501584 [info ] [MainThread]: adapter type: postgres
[0m11:47:23.502584 [info ] [MainThread]: adapter version: 1.7.11
[0m11:47:23.604864 [info ] [MainThread]: Configuration:
[0m11:47:23.605420 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:47:23.606430 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:47:23.607490 [info ] [MainThread]: Required dependencies:
[0m11:47:23.608428 [debug] [MainThread]: Executing "git --help"
[0m11:47:23.644146 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:47:23.646147 [debug] [MainThread]: STDERR: "b''"
[0m11:47:23.648152 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:47:23.649149 [info ] [MainThread]: Connection:
[0m11:47:23.650171 [info ] [MainThread]:   host: aws-adw.czmo6y6u8ehp.ap-southeast-1.rds.amazonaws.com
[0m11:47:23.651177 [info ] [MainThread]:   port: 5432
[0m11:47:23.652179 [info ] [MainThread]:   user: postgres
[0m11:47:23.652551 [info ] [MainThread]:   database: adventureworks2022
[0m11:47:23.653558 [info ] [MainThread]:   schema: dbt
[0m11:47:23.653877 [info ] [MainThread]:   connect_timeout: 10
[0m11:47:23.654885 [info ] [MainThread]:   role: None
[0m11:47:23.654885 [info ] [MainThread]:   search_path: None
[0m11:47:23.655929 [info ] [MainThread]:   keepalives_idle: 0
[0m11:47:23.656888 [info ] [MainThread]:   sslmode: None
[0m11:47:23.656888 [info ] [MainThread]:   sslcert: None
[0m11:47:23.657886 [info ] [MainThread]:   sslkey: None
[0m11:47:23.658887 [info ] [MainThread]:   sslrootcert: None
[0m11:47:23.658887 [info ] [MainThread]:   application_name: dbt
[0m11:47:23.659891 [info ] [MainThread]:   retries: 1
[0m11:47:23.660887 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m11:47:23.661885 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:47:23.662931 [debug] [MainThread]: Using postgres connection "debug"
[0m11:47:23.663996 [debug] [MainThread]: On debug: select 1 as id
[0m11:47:23.664965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:24.185966 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m11:47:24.186966 [debug] [MainThread]: On debug: Close
[0m11:47:24.187965 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:47:24.188970 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:47:24.190967 [debug] [MainThread]: Command `dbt debug` succeeded at 11:47:24.190967 after 0.86 seconds
[0m11:47:24.190967 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:47:24.191966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013160E51750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013166A059D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001316651AC90>]}
[0m11:47:24.192964 [debug] [MainThread]: Flushing usage events
[0m12:41:42.675300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B7B8E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B7BA8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B7BA7D0>]}


============================== 12:41:42.681855 | d78a7a21-b627-4951-b204-23b240210b06 ==============================
[0m12:41:42.681855 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:41:42.682773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:42.926417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd78a7a21-b627-4951-b204-23b240210b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B9BFED0>]}
[0m12:41:43.011470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd78a7a21-b627-4951-b204-23b240210b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B9BFED0>]}
[0m12:41:43.013365 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:41:43.041421 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:41:43.043368 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:41:43.044366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd78a7a21-b627-4951-b204-23b240210b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B9A75D0>]}
[0m12:41:45.423836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_etl_adw.example
[0m12:41:45.429926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd78a7a21-b627-4951-b204-23b240210b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999BB33750>]}
[0m12:41:45.496985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd78a7a21-b627-4951-b204-23b240210b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999BD0D1D0>]}
[0m12:41:45.497987 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:41:45.498985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd78a7a21-b627-4951-b204-23b240210b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999BB55710>]}
[0m12:41:45.500496 [info ] [MainThread]: 
[0m12:41:45.501497 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:41:45.502497 [debug] [MainThread]: Command end result
[0m12:41:45.511501 [debug] [MainThread]: Command `dbt test` succeeded at 12:41:45.511501 after 2.90 seconds
[0m12:41:45.512503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299949E1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999BB56A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029994CC8550>]}
[0m12:41:45.513499 [debug] [MainThread]: Flushing usage events
[0m12:42:24.321452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023789D49110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023789D4A710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023789D4A0D0>]}


============================== 12:42:24.324737 | a366cb13-94a2-4bf9-8385-f2e0ee09953f ==============================
[0m12:42:24.324737 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:42:24.325736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:24.326734 [info ] [MainThread]: dbt version: 1.7.11
[0m12:42:24.327733 [info ] [MainThread]: python version: 3.11.5
[0m12:42:24.328794 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m12:42:24.328794 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m12:42:24.413663 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m12:42:24.414635 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m12:42:24.415573 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m12:42:24.417247 [info ] [MainThread]: adapter type: postgres
[0m12:42:24.418297 [info ] [MainThread]: adapter version: 1.7.11
[0m12:42:24.490418 [info ] [MainThread]: Configuration:
[0m12:42:24.491927 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:42:24.492732 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:42:24.493762 [info ] [MainThread]: Required dependencies:
[0m12:42:24.494769 [debug] [MainThread]: Executing "git --help"
[0m12:42:24.536439 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:42:24.537441 [debug] [MainThread]: STDERR: "b''"
[0m12:42:24.538442 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:42:24.539439 [info ] [MainThread]: Connection:
[0m12:42:24.540438 [info ] [MainThread]:   host: aws-adw.czmo6y6u8ehp.ap-southeast-1.rds.amazonaws.com
[0m12:42:24.541438 [info ] [MainThread]:   port: 5432
[0m12:42:24.543455 [info ] [MainThread]:   user: postgres
[0m12:42:24.544441 [info ] [MainThread]:   database: adventureworks2022
[0m12:42:24.545437 [info ] [MainThread]:   schema: dbt
[0m12:42:24.545437 [info ] [MainThread]:   connect_timeout: 10
[0m12:42:24.546438 [info ] [MainThread]:   role: None
[0m12:42:24.547438 [info ] [MainThread]:   search_path: None
[0m12:42:24.547438 [info ] [MainThread]:   keepalives_idle: 0
[0m12:42:24.548436 [info ] [MainThread]:   sslmode: None
[0m12:42:24.549435 [info ] [MainThread]:   sslcert: None
[0m12:42:24.550440 [info ] [MainThread]:   sslkey: None
[0m12:42:24.551440 [info ] [MainThread]:   sslrootcert: None
[0m12:42:24.551440 [info ] [MainThread]:   application_name: dbt
[0m12:42:24.552439 [info ] [MainThread]:   retries: 1
[0m12:42:24.553442 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:42:24.554440 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:42:24.554440 [debug] [MainThread]: Using postgres connection "debug"
[0m12:42:24.555449 [debug] [MainThread]: On debug: select 1 as id
[0m12:42:24.555449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:25.293998 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m12:42:25.296993 [debug] [MainThread]: On debug: Close
[0m12:42:25.298995 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:42:25.301121 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:42:25.303797 [debug] [MainThread]: Command `dbt debug` succeeded at 12:42:25.302628 after 1.05 seconds
[0m12:42:25.303797 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:42:25.304820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023782FA1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023789A8B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023788618A50>]}
[0m12:42:25.305789 [debug] [MainThread]: Flushing usage events
[0m12:44:40.293285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A97FAE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A92F43D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A97FAFD0>]}


============================== 12:44:40.298284 | 670731f2-c908-415c-8395-af8a46823f78 ==============================
[0m12:44:40.298284 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:44:40.299286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --models trans_sales_orders', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:40.495966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '670731f2-c908-415c-8395-af8a46823f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A983A710>]}
[0m12:44:40.574492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '670731f2-c908-415c-8395-af8a46823f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A86AB690>]}
[0m12:44:40.576229 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:44:40.586236 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:44:40.670118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:40.671116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:40.672116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_etl_adw.example
[0m12:44:40.678571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '670731f2-c908-415c-8395-af8a46823f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A9920510>]}
[0m12:44:40.691850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '670731f2-c908-415c-8395-af8a46823f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A9B13390>]}
[0m12:44:40.692851 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:44:40.693854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '670731f2-c908-415c-8395-af8a46823f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A9991490>]}
[0m12:44:40.694854 [warn ] [MainThread]: The selection criterion 'trans_sales_orders' does not match any nodes
[0m12:44:40.697883 [info ] [MainThread]: 
[0m12:44:40.698852 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:44:40.700314 [debug] [MainThread]: Command end result
[0m12:44:40.713371 [debug] [MainThread]: Command `dbt test` succeeded at 12:44:40.713371 after 0.50 seconds
[0m12:44:40.714375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A92F4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A2A117D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A2D04490>]}
[0m12:44:40.715382 [debug] [MainThread]: Flushing usage events
[0m12:50:11.534530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C67083D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C670AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C6709710>]}


============================== 12:50:11.538540 | 6cdb62e5-0edf-4232-9c73-b27dfb8373cc ==============================
[0m12:50:11.538540 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:50:11.539543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:50:11.718222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cdb62e5-0edf-4232-9c73-b27dfb8373cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C690C390>]}
[0m12:50:11.798974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cdb62e5-0edf-4232-9c73-b27dfb8373cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C68547D0>]}
[0m12:50:11.800948 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m12:50:11.808796 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:50:11.815751 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:50:11.816791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6cdb62e5-0edf-4232-9c73-b27dfb8373cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C6762490>]}
[0m12:50:12.699321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cdb62e5-0edf-4232-9c73-b27dfb8373cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C6A00B50>]}
[0m12:50:12.711968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cdb62e5-0edf-4232-9c73-b27dfb8373cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C6C78290>]}
[0m12:50:12.712969 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:50:12.713969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cdb62e5-0edf-4232-9c73-b27dfb8373cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C6C8FC50>]}
[0m12:50:12.715778 [info ] [MainThread]: 
[0m12:50:12.716692 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:50:12.717692 [debug] [MainThread]: Command end result
[0m12:50:12.730067 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:12.729067 after 1.27 seconds
[0m12:50:12.731064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3BF981750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3C4008A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3BFC6B910>]}
[0m12:50:12.731568 [debug] [MainThread]: Flushing usage events
[0m13:01:38.986941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E23D78F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E23D7B010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E23D78C90>]}


============================== 13:01:38.990963 | 7e2053ce-7752-4ca1-b1e0-766f6bfcecf7 ==============================
[0m13:01:38.990963 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:01:38.992941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:39.199183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e2053ce-7752-4ca1-b1e0-766f6bfcecf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E23F59910>]}
[0m13:01:39.289784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e2053ce-7752-4ca1-b1e0-766f6bfcecf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E239E5A50>]}
[0m13:01:39.291781 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m13:01:39.299784 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:01:39.385064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:39.386152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:39.392133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e2053ce-7752-4ca1-b1e0-766f6bfcecf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E23DF8E10>]}
[0m13:01:39.405128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e2053ce-7752-4ca1-b1e0-766f6bfcecf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E24093690>]}
[0m13:01:39.406123 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:01:39.407123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e2053ce-7752-4ca1-b1e0-766f6bfcecf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E23FE5110>]}
[0m13:01:39.409122 [info ] [MainThread]: 
[0m13:01:39.409122 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:39.410122 [debug] [MainThread]: Command end result
[0m13:01:39.420686 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:39.420686 after 0.50 seconds
[0m13:01:39.422070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1D001850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E22648A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E1D2EB690>]}
[0m13:01:39.423132 [debug] [MainThread]: Flushing usage events
[0m13:06:59.576804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021857FB90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021857FBB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021857FBAC90>]}


============================== 13:06:59.582632 | fbc8dc92-d0e9-4870-ab00-09563f8029e6 ==============================
[0m13:06:59.582632 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:06:59.583556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_sales_header', 'send_anonymous_usage_stats': 'True'}
[0m13:06:59.804741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc8dc92-d0e9-4870-ab00-09563f8029e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021858148210>]}
[0m13:06:59.881339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc8dc92-d0e9-4870-ab00-09563f8029e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218581047D0>]}
[0m13:06:59.883257 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m13:06:59.892265 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:06:59.969716 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_etl_adw: transform\schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version:2
    2  | 
    3  | models:
    4  |   - name: trans_sales_orders
    5  |     columns:
    6  |       - name: SalesOrderID
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 7
[0m13:06:59.971697 [debug] [MainThread]: Command `dbt run` failed at 13:06:59.971697 after 0.45 seconds
[0m13:06:59.972605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218512917D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021851578590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021857FBB750>]}
[0m13:06:59.972605 [debug] [MainThread]: Flushing usage events
[0m13:08:53.814057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F610110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935EA28150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F5EF690>]}


============================== 13:08:53.818503 | 36a2d87a-1940-4f15-b867-275fe533e33e ==============================
[0m13:08:53.818503 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:08:53.819689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_sales_header', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:08:54.024764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36a2d87a-1940-4f15-b867-275fe533e33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F618F50>]}
[0m13:08:54.113606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36a2d87a-1940-4f15-b867-275fe533e33e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F647FD0>]}
[0m13:08:54.114630 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m13:08:54.124607 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:08:54.215185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m13:08:54.216187 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\schema.yml
[0m13:08:54.217186 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\schema.yml
[0m13:08:54.217186 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\sources.yml
[0m13:08:54.218189 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\marts\fact_sales.sql
[0m13:08:54.218189 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_details.sql
[0m13:08:54.219190 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m13:08:54.219190 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m13:08:54.220186 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m13:08:54.413889 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_header' in the 'models' section of file 'models\staging\schema.yml'
[0m13:08:54.417824 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_order_detail' in the 'models' section of file 'models\staging\schema.yml'
[0m13:08:54.567851 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_etl_adw.trans_sales_orders' (models\transform\trans_sales_orders.sql) depends on a node named 'stg_sales_order_detail' which was not found
[0m13:08:54.569857 [debug] [MainThread]: Command `dbt run` failed at 13:08:54.568858 after 0.82 seconds
[0m13:08:54.569857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193587F17D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F03CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019358A866D0>]}
[0m13:08:54.570948 [debug] [MainThread]: Flushing usage events
[0m16:12:37.157482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562DDAA250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562DDAAC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562DDA8E50>]}


============================== 16:12:37.164598 | 829d8f8f-e21a-4e2a-b18f-ddaafecdc691 ==============================
[0m16:12:37.164598 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:12:37.165618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_sales_header', 'send_anonymous_usage_stats': 'True'}
[0m16:12:37.403464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '829d8f8f-e21a-4e2a-b18f-ddaafecdc691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562DF44E50>]}
[0m16:12:37.485505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '829d8f8f-e21a-4e2a-b18f-ddaafecdc691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562D8A4710>]}
[0m16:12:37.488517 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:12:37.498460 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:12:37.594270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m16:12:37.595624 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\schema.yml
[0m16:12:37.595624 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\sources.yml
[0m16:12:37.597016 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\schema.yml
[0m16:12:37.597016 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m16:12:37.598024 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m16:12:37.598024 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:12:37.599028 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_details.sql
[0m16:12:37.599028 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\marts\fact_sales.sql
[0m16:12:37.932795 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_order_detail' in the 'models' section of file 'models\staging\schema.yml'
[0m16:12:37.933719 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_header' in the 'models' section of file 'models\staging\schema.yml'
[0m16:12:37.950712 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_etl_adw.trans_sales_orders' (models\transform\trans_sales_orders.sql) depends on a node named 'stg_sales_order_detail' which was not found
[0m16:12:37.952813 [debug] [MainThread]: Command `dbt run` failed at 16:12:37.951712 after 0.86 seconds
[0m16:12:37.953710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562DDA9E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562E360090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256270517D0>]}
[0m16:12:37.953710 [debug] [MainThread]: Flushing usage events
[0m16:14:01.306735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BA82AF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BA83C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BA83EA50>]}


============================== 16:14:01.310683 | 4bb31124-71ba-4d45-abaf-809b1e93cc91 ==============================
[0m16:14:01.310683 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:14:01.312526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_sales_header', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:14:01.514116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb31124-71ba-4d45-abaf-809b1e93cc91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BA829950>]}
[0m16:14:01.594212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb31124-71ba-4d45-abaf-809b1e93cc91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BAA2FED0>]}
[0m16:14:01.595887 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:14:01.604271 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:14:01.666566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m16:14:01.666566 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\schema.yml
[0m16:14:01.667570 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\sources.yml
[0m16:14:01.668566 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\schema.yml
[0m16:14:01.668566 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:14:01.669593 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m16:14:01.669593 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_details.sql
[0m16:14:01.670535 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\marts\fact_sales.sql
[0m16:14:01.670535 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m16:14:01.858422 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_header' in the 'models' section of file 'models\staging\schema.yml'
[0m16:14:01.861798 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_order_detail' in the 'models' section of file 'models\staging\schema.yml'
[0m16:14:02.042947 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_etl_adw.trans_sales_orders' (models\transform\trans_sales_orders.sql) depends on a node named 'stg_sales_order_detail' which was not found
[0m16:14:02.044892 [debug] [MainThread]: Command `dbt run` failed at 16:14:02.044892 after 0.80 seconds
[0m16:14:02.045954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5B3A317D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BA83E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5BAD42A10>]}
[0m16:14:02.045954 [debug] [MainThread]: Flushing usage events
[0m16:20:08.841636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B6E8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B6EB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B6E8C50>]}


============================== 16:20:08.846061 | 2091a70e-7f76-4124-bce6-923b8538b0b7 ==============================
[0m16:20:08.846061 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:20:08.848061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_sales_header', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:09.059911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2091a70e-7f76-4124-bce6-923b8538b0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2AB4C050>]}
[0m16:20:09.172315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2091a70e-7f76-4124-bce6-923b8538b0b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B734310>]}
[0m16:20:09.174315 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:20:09.190773 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:20:09.261568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m16:20:09.262570 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\schema.yml
[0m16:20:09.262570 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\sources.yml
[0m16:20:09.263579 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\schema.yml
[0m16:20:09.263579 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\marts\fact_sales.sql
[0m16:20:09.264579 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m16:20:09.264579 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m16:20:09.265578 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_details.sql
[0m16:20:09.265578 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:20:09.673629 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_etl_adw.trans_sales_orders' (models\transform\trans_sales_orders.sql) depends on a node named 'stg_sales_order_detail' which was not found
[0m16:20:09.676631 [debug] [MainThread]: Command `dbt run` failed at 16:20:09.675629 after 0.92 seconds
[0m16:20:09.676631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B7436D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B98AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B737B10>]}
[0m16:20:09.677629 [debug] [MainThread]: Flushing usage events
[0m16:21:16.030913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3CB08FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3B9B8810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3CB0B190>]}


============================== 16:21:16.034496 | 0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f ==============================
[0m16:21:16.034496 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:21:16.035911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_sales_header', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:21:16.235600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3CC4B650>]}
[0m16:21:16.329340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3A41FF90>]}
[0m16:21:16.331342 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:21:16.342497 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:21:16.414038 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 7 files changed.
[0m16:21:16.415043 [debug] [MainThread]: Partial parsing: added file: dbt_etl_adw://models\staging\stg_sales_order_detail.sql
[0m16:21:16.415043 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\schema.yml
[0m16:21:16.415043 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\sources.yml
[0m16:21:16.416363 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\schema.yml
[0m16:21:16.416363 [debug] [MainThread]: Partial parsing: deleted file: dbt_etl_adw://models\staging\stg_sales_order_details.sql
[0m16:21:16.417534 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:21:16.417534 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m16:21:16.418541 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\marts\fact_sales.sql
[0m16:21:16.418541 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m16:21:16.752310 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_sales_order_details' in the 'models' section of file 'models\staging\schema.yml'
[0m16:21:16.772556 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_etl_adw.not_null_stg_sales_order_details_SalesOrderID.87c56805ef' (models\staging\schema.yml) depends on a node named 'stg_sales_order_details' in package '' which was not found
[0m16:21:16.774062 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_etl_adw.not_null_stg_sales_order_details_ProductID.d6a7ddbdbb' (models\staging\schema.yml) depends on a node named 'stg_sales_order_details' in package '' which was not found
[0m16:21:16.792420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3D196810>]}
[0m16:21:16.813918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3CE95050>]}
[0m16:21:16.814627 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:21:16.814627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3CDC8E10>]}
[0m16:21:16.817633 [info ] [MainThread]: 
[0m16:21:16.821164 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:16.823169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:21:16.836563 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:21:16.838576 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:21:16.838576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:17.366596 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:21:17.370903 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:21:17.376463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_dbt'
[0m16:21:17.384657 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:21:17.385611 [debug] [ThreadPool]: On list_adventureworks2022_dbt: BEGIN
[0m16:21:17.385611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:17.875443 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:21:17.876509 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:21:17.876509 [debug] [ThreadPool]: On list_adventureworks2022_dbt: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_dbt"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:21:17.936756 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:21:17.937754 [debug] [ThreadPool]: On list_adventureworks2022_dbt: ROLLBACK
[0m16:21:17.989768 [debug] [ThreadPool]: On list_adventureworks2022_dbt: Close
[0m16:21:17.996774 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:17.997772 [debug] [MainThread]: On master: BEGIN
[0m16:21:17.997772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:18.650797 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:21:18.651791 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:18.652798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:18.727254 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:21:18.731337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3D0302D0>]}
[0m16:21:18.732275 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:18.800768 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:18.800768 [debug] [MainThread]: On master: BEGIN
[0m16:21:18.934058 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:21:18.934058 [debug] [MainThread]: On master: COMMIT
[0m16:21:18.935048 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:18.935048 [debug] [MainThread]: On master: COMMIT
[0m16:21:19.002639 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:21:19.002639 [debug] [MainThread]: On master: Close
[0m16:21:19.004686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:19.005811 [info ] [MainThread]: 
[0m16:21:19.020237 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:21:19.020237 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.stg_sales_header ............................... [RUN]
[0m16:21:19.022245 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:21:19.023246 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:21:19.035685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:21:19.038651 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:21:19.023246 => 16:21:19.038651
[0m16:21:19.040022 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:21:19.083327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:21:19.086686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:21:19.087695 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:21:19.087695 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:19.674769 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:21:19.676889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:21:19.677891 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."dbt"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        SalesOrderID,
        CustomerID,
        OrderDate,
        TotalDue
    from "adventureworks2022"."adw"."sales_header"
)
select * from sales_header;
  );
[0m16:21:19.741789 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:21:19.743905 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:21:19.808193 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:21:19.041028 => 16:21:19.807166
[0m16:21:19.809188 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:21:19.954626 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:21:19.955625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0f65d1-a7c5-45c6-88ae-cdd1c54ed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3D25D050>]}
[0m16:21:19.956626 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt.stg_sales_header ...................... [[31mERROR[0m in 0.93s]
[0m16:21:19.957619 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:21:19.960622 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:19.961621 [debug] [MainThread]: On master: BEGIN
[0m16:21:19.961621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:20.621453 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:21:20.622455 [debug] [MainThread]: On master: COMMIT
[0m16:21:20.623454 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:20.623454 [debug] [MainThread]: On master: COMMIT
[0m16:21:20.694144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:21:20.695172 [debug] [MainThread]: On master: Close
[0m16:21:20.698153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:20.699144 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:21:20.700149 [debug] [MainThread]: Connection 'list_adventureworks2022_dbt' was properly closed.
[0m16:21:20.701248 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_header' was properly closed.
[0m16:21:20.702163 [info ] [MainThread]: 
[0m16:21:20.703209 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m16:21:20.704346 [debug] [MainThread]: Command end result
[0m16:21:20.721333 [info ] [MainThread]: 
[0m16:21:20.722336 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:21:20.723838 [info ] [MainThread]: 
[0m16:21:20.725858 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:21:20.726894 [info ] [MainThread]: 
[0m16:21:20.727845 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:21:20.729846 [debug] [MainThread]: Command `dbt run` failed at 16:21:20.729846 after 4.77 seconds
[0m16:21:20.730891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C35D717D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3CB60950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C3CB600D0>]}
[0m16:21:20.731899 [debug] [MainThread]: Flushing usage events
[0m16:24:53.194576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39B78C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39B7AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39B78D10>]}


============================== 16:24:53.199593 | 83de0352-ab7a-4885-9c14-8ce35768c25d ==============================
[0m16:24:53.199593 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:24:53.201592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_sales_header', 'send_anonymous_usage_stats': 'True'}
[0m16:24:53.406587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83de0352-ab7a-4885-9c14-8ce35768c25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39CA8610>]}
[0m16:24:53.505388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83de0352-ab7a-4885-9c14-8ce35768c25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39CA8610>]}
[0m16:24:53.507092 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:24:53.515191 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:24:53.613504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:53.613504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:53.621504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83de0352-ab7a-4885-9c14-8ce35768c25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39F4A3D0>]}
[0m16:24:53.636017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83de0352-ab7a-4885-9c14-8ce35768c25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39D8F5D0>]}
[0m16:24:53.636017 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:24:53.637212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83de0352-ab7a-4885-9c14-8ce35768c25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39DD39D0>]}
[0m16:24:53.640486 [info ] [MainThread]: 
[0m16:24:53.641395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:53.643475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:24:53.653479 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:24:53.654399 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:24:53.655396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:54.271338 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:24:54.275336 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:24:54.280338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_dbt'
[0m16:24:54.286411 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:24:54.287349 [debug] [ThreadPool]: On list_adventureworks2022_dbt: BEGIN
[0m16:24:54.287349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:54.792260 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:24:54.792260 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:24:54.792260 [debug] [ThreadPool]: On list_adventureworks2022_dbt: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_dbt"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:24:54.849207 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:24:54.850719 [debug] [ThreadPool]: On list_adventureworks2022_dbt: ROLLBACK
[0m16:24:54.901696 [debug] [ThreadPool]: On list_adventureworks2022_dbt: Close
[0m16:24:54.907204 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:54.907204 [debug] [MainThread]: On master: BEGIN
[0m16:24:54.908204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:55.517247 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:24:55.518758 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:55.518758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:55.615324 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:24:55.616323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83de0352-ab7a-4885-9c14-8ce35768c25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39DF0B50>]}
[0m16:24:55.617833 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:55.676163 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:55.680149 [debug] [MainThread]: On master: BEGIN
[0m16:24:55.882541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:24:55.882541 [debug] [MainThread]: On master: COMMIT
[0m16:24:55.883540 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:55.884537 [debug] [MainThread]: On master: COMMIT
[0m16:24:55.935807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:24:55.936806 [debug] [MainThread]: On master: Close
[0m16:24:55.938806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:55.939806 [info ] [MainThread]: 
[0m16:24:55.943884 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:24:55.945100 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.stg_sales_header ............................... [RUN]
[0m16:24:55.946613 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:24:55.947622 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:24:55.961209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:24:55.962209 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:24:55.949199 => 16:24:55.962209
[0m16:24:55.963213 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:24:56.013231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:24:56.014231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:24:56.015229 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:24:56.015229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:56.965976 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:24:56.968098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:24:56.969079 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."dbt"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        SalesOrderID,
        CustomerID,
        OrderDate,
        TotalDue
    from "adventureworks2022"."adw"."sales_header"
)
select * from sales_header;
  );
[0m16:24:57.110725 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:24:57.110725 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:24:57.172802 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:24:55.964208 => 16:24:57.171802
[0m16:24:57.172802 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:24:57.180616 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:24:57.181615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83de0352-ab7a-4885-9c14-8ce35768c25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B393EE290>]}
[0m16:24:57.182619 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt.stg_sales_header ...................... [[31mERROR[0m in 1.24s]
[0m16:24:57.184617 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:24:57.186615 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:57.188030 [debug] [MainThread]: On master: BEGIN
[0m16:24:57.189041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:58.193897 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:24:58.194943 [debug] [MainThread]: On master: COMMIT
[0m16:24:58.195932 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:58.196919 [debug] [MainThread]: On master: COMMIT
[0m16:24:58.339849 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:24:58.340925 [debug] [MainThread]: On master: Close
[0m16:24:58.342841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:58.343843 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:24:58.344846 [debug] [MainThread]: Connection 'list_adventureworks2022_dbt' was properly closed.
[0m16:24:58.345843 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_header' was properly closed.
[0m16:24:58.346842 [info ] [MainThread]: 
[0m16:24:58.347850 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m16:24:58.350853 [debug] [MainThread]: Command end result
[0m16:24:58.371952 [info ] [MainThread]: 
[0m16:24:58.372955 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:24:58.374954 [info ] [MainThread]: 
[0m16:24:58.377177 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:24:58.378188 [info ] [MainThread]: 
[0m16:24:58.379180 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:24:58.382188 [debug] [MainThread]: Command `dbt run` failed at 16:24:58.381178 after 5.26 seconds
[0m16:24:58.383180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B32E517D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3313B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3313B850>]}
[0m16:24:58.383180 [debug] [MainThread]: Flushing usage events
[0m16:25:23.630660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388DA0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388D771D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388DA2B50>]}


============================== 16:25:23.635448 | 81ac5649-ba31-4457-9bf2-4e9700f9dc04 ==============================
[0m16:25:23.635448 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:25:23.636450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_sales_header', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:23.842589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81ac5649-ba31-4457-9bf2-4e9700f9dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388F040D0>]}
[0m16:25:23.943225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81ac5649-ba31-4457-9bf2-4e9700f9dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388DB80D0>]}
[0m16:25:23.944226 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:25:23.954223 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:25:24.022009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:24.022992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:24.030003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81ac5649-ba31-4457-9bf2-4e9700f9dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029389151990>]}
[0m16:25:24.043223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81ac5649-ba31-4457-9bf2-4e9700f9dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029389029F50>]}
[0m16:25:24.044137 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:25:24.045133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ac5649-ba31-4457-9bf2-4e9700f9dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938904BED0>]}
[0m16:25:24.047136 [info ] [MainThread]: 
[0m16:25:24.048133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:24.049568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:25:24.059575 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:25:24.060576 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:25:24.060576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:24.762155 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:25:24.763160 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:25:24.766161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_dbt'
[0m16:25:24.771161 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:25:24.772167 [debug] [ThreadPool]: On list_adventureworks2022_dbt: BEGIN
[0m16:25:24.772167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:25.453986 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:25:25.453986 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:25:25.456003 [debug] [ThreadPool]: On list_adventureworks2022_dbt: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_dbt"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:25:25.564048 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:25:25.566057 [debug] [ThreadPool]: On list_adventureworks2022_dbt: ROLLBACK
[0m16:25:25.637229 [debug] [ThreadPool]: On list_adventureworks2022_dbt: Close
[0m16:25:25.642184 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:25.643171 [debug] [MainThread]: On master: BEGIN
[0m16:25:25.643171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:26.232674 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:25:26.233675 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.234666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:26.299375 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:25:26.301384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81ac5649-ba31-4457-9bf2-4e9700f9dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388FC3410>]}
[0m16:25:26.301384 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:26.362096 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.362096 [debug] [MainThread]: On master: BEGIN
[0m16:25:26.484015 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:25:26.484015 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.485064 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:26.485064 [debug] [MainThread]: On master: COMMIT
[0m16:25:26.546502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:25:26.547015 [debug] [MainThread]: On master: Close
[0m16:25:26.549031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:26.550034 [info ] [MainThread]: 
[0m16:25:26.554033 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:25:26.555040 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.stg_sales_header ............................... [RUN]
[0m16:25:26.556026 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:25:26.557118 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:25:26.568565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:25:26.569549 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:25:26.558131 => 16:25:26.569549
[0m16:25:26.570529 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:25:26.615698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:25:26.617709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:25:26.618700 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:25:26.618700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:25:27.257543 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:25:27.258431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:25:27.259427 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."dbt"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        SalesOrderID,
        CustomerID,
        OrderDate,
        TotalDue
    from "adventureworks2022"."adw"."sales_header"
)
select * from sales_header;
  );
[0m16:25:27.327656 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:25:27.329563 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:25:27.397538 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:25:26.570529 => 16:25:27.396541
[0m16:25:27.398537 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:25:27.402536 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:25:27.403537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81ac5649-ba31-4457-9bf2-4e9700f9dc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029388DEA850>]}
[0m16:25:27.404538 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt.stg_sales_header ...................... [[31mERROR[0m in 0.85s]
[0m16:25:27.405537 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:25:27.408544 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:27.408544 [debug] [MainThread]: On master: BEGIN
[0m16:25:27.409536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:27.969790 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:25:27.969790 [debug] [MainThread]: On master: COMMIT
[0m16:25:27.970790 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:27.971789 [debug] [MainThread]: On master: COMMIT
[0m16:25:28.030540 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:25:28.030540 [debug] [MainThread]: On master: Close
[0m16:25:28.031535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:28.032536 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:25:28.032536 [debug] [MainThread]: Connection 'list_adventureworks2022_dbt' was properly closed.
[0m16:25:28.032536 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_header' was properly closed.
[0m16:25:28.033536 [info ] [MainThread]: 
[0m16:25:28.034539 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m16:25:28.036620 [debug] [MainThread]: Command end result
[0m16:25:28.045537 [info ] [MainThread]: 
[0m16:25:28.046544 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:25:28.047553 [info ] [MainThread]: 
[0m16:25:28.048546 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:25:28.050576 [info ] [MainThread]: 
[0m16:25:28.050576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:25:28.053936 [debug] [MainThread]: Command `dbt run` failed at 16:25:28.052890 after 4.49 seconds
[0m16:25:28.054953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029381FF17D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293822E4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293822D8450>]}
[0m16:25:28.056013 [debug] [MainThread]: Flushing usage events
[0m16:31:33.935963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FD868CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FC2440D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FD8BB510>]}


============================== 16:31:33.939279 | aeb67e82-1ab2-4f95-86b9-d74cc8a2959a ==============================
[0m16:31:33.939279 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:31:33.941281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_sales_header', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:34.120701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aeb67e82-1ab2-4f95-86b9-d74cc8a2959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FD8D7E90>]}
[0m16:31:34.199398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aeb67e82-1ab2-4f95-86b9-d74cc8a2959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FDA68090>]}
[0m16:31:34.200591 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:31:34.209686 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:31:34.269804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:34.270908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:34.276889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aeb67e82-1ab2-4f95-86b9-d74cc8a2959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FDC3AB10>]}
[0m16:31:34.298023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aeb67e82-1ab2-4f95-86b9-d74cc8a2959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FDA85610>]}
[0m16:31:34.298023 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:31:34.299230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeb67e82-1ab2-4f95-86b9-d74cc8a2959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FD8AA450>]}
[0m16:31:34.301233 [info ] [MainThread]: 
[0m16:31:34.302244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:34.304267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:31:34.315240 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:31:34.316244 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:31:34.317250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:34.937568 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:31:34.939569 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:31:34.941570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_dbt'
[0m16:31:34.947574 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:31:34.947574 [debug] [ThreadPool]: On list_adventureworks2022_dbt: BEGIN
[0m16:31:34.948573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:35.432171 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:31:35.433173 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:31:35.434173 [debug] [ThreadPool]: On list_adventureworks2022_dbt: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_dbt"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:31:35.490658 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:31:35.491666 [debug] [ThreadPool]: On list_adventureworks2022_dbt: ROLLBACK
[0m16:31:35.542657 [debug] [ThreadPool]: On list_adventureworks2022_dbt: Close
[0m16:31:35.549970 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:35.550968 [debug] [MainThread]: On master: BEGIN
[0m16:31:35.550968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:36.095274 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:31:36.095274 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:36.096274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:36.158975 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:31:36.159978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeb67e82-1ab2-4f95-86b9-d74cc8a2959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FDB30210>]}
[0m16:31:36.160987 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:36.219440 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:36.219440 [debug] [MainThread]: On master: BEGIN
[0m16:31:36.335821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:31:36.336823 [debug] [MainThread]: On master: COMMIT
[0m16:31:36.337821 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:36.337821 [debug] [MainThread]: On master: COMMIT
[0m16:31:36.397099 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:31:36.398101 [debug] [MainThread]: On master: Close
[0m16:31:36.400098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:36.401100 [info ] [MainThread]: 
[0m16:31:36.403545 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:31:36.404762 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.stg_sales_header ............................... [RUN]
[0m16:31:36.406129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:31:36.407537 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:31:36.419145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:31:36.421147 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:31:36.408876 => 16:31:36.420146
[0m16:31:36.421147 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:31:36.465518 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:31:36.467539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:31:36.468520 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:31:36.468520 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:31:37.047436 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:31:37.048438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:31:37.048438 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."dbt"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        SalesOrderID,
        CustomerID,
        OrderDate,
        TotalDue
    from "adventureworks2022"."adw"."sales_header"
)
select * from sales_header;
  );
[0m16:31:37.112394 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:31:37.113393 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:31:37.175609 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:31:36.421147 => 16:31:37.175609
[0m16:31:37.176761 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:31:37.181759 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:31:37.181759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aeb67e82-1ab2-4f95-86b9-d74cc8a2959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233FDC26290>]}
[0m16:31:37.182760 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt.stg_sales_header ...................... [[31mERROR[0m in 0.78s]
[0m16:31:37.183760 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:31:37.186220 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:37.186220 [debug] [MainThread]: On master: BEGIN
[0m16:31:37.187226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:37.741922 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:31:37.741922 [debug] [MainThread]: On master: COMMIT
[0m16:31:37.742927 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:37.742927 [debug] [MainThread]: On master: COMMIT
[0m16:31:37.803084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:31:37.804087 [debug] [MainThread]: On master: Close
[0m16:31:37.805085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:37.805085 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:31:37.806164 [debug] [MainThread]: Connection 'list_adventureworks2022_dbt' was properly closed.
[0m16:31:37.806164 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_header' was properly closed.
[0m16:31:37.806164 [info ] [MainThread]: 
[0m16:31:37.807160 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m16:31:37.808162 [debug] [MainThread]: Command end result
[0m16:31:37.817651 [info ] [MainThread]: 
[0m16:31:37.819661 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:31:37.819661 [info ] [MainThread]: 
[0m16:31:37.821662 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:31:37.822771 [info ] [MainThread]: 
[0m16:31:37.825781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:31:37.827297 [debug] [MainThread]: Command `dbt run` failed at 16:31:37.826784 after 3.97 seconds
[0m16:31:37.827297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F6AB17D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F6DA4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F6D466D0>]}
[0m16:31:37.828302 [debug] [MainThread]: Flushing usage events
[0m16:32:49.324031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE9056AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE9057A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE9056990>]}


============================== 16:32:49.328544 | 5b69840f-cfe3-40ff-8e3b-4722d3c84d3c ==============================
[0m16:32:49.328544 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:32:49.328544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:32:49.329972 [info ] [MainThread]: dbt version: 1.7.11
[0m16:32:49.330979 [info ] [MainThread]: python version: 3.11.5
[0m16:32:49.331979 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m16:32:49.332980 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m16:32:49.436460 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m16:32:49.436460 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m16:32:49.437968 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m16:32:49.439975 [info ] [MainThread]: adapter type: postgres
[0m16:32:49.440974 [info ] [MainThread]: adapter version: 1.7.11
[0m16:32:49.522620 [info ] [MainThread]: Configuration:
[0m16:32:49.524128 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:32:49.525291 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:32:49.526530 [info ] [MainThread]: Required dependencies:
[0m16:32:49.527541 [debug] [MainThread]: Executing "git --help"
[0m16:32:49.565767 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:32:49.566770 [debug] [MainThread]: STDERR: "b''"
[0m16:32:49.566770 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:32:49.568276 [info ] [MainThread]: Connection:
[0m16:32:49.569285 [info ] [MainThread]:   host: aws-adw.czmo6y6u8ehp.ap-southeast-1.rds.amazonaws.com
[0m16:32:49.570284 [info ] [MainThread]:   port: 5432
[0m16:32:49.572298 [info ] [MainThread]:   user: postgres
[0m16:32:49.573834 [info ] [MainThread]:   database: adventureworks2022
[0m16:32:49.574845 [info ] [MainThread]:   schema: dbt
[0m16:32:49.575899 [info ] [MainThread]:   connect_timeout: 10
[0m16:32:49.576846 [info ] [MainThread]:   role: None
[0m16:32:49.577844 [info ] [MainThread]:   search_path: None
[0m16:32:49.579352 [info ] [MainThread]:   keepalives_idle: 0
[0m16:32:49.580360 [info ] [MainThread]:   sslmode: None
[0m16:32:49.581359 [info ] [MainThread]:   sslcert: None
[0m16:32:49.582648 [info ] [MainThread]:   sslkey: None
[0m16:32:49.584656 [info ] [MainThread]:   sslrootcert: None
[0m16:32:49.584656 [info ] [MainThread]:   application_name: dbt
[0m16:32:49.586861 [info ] [MainThread]:   retries: 1
[0m16:32:49.587871 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:32:49.588870 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:32:49.588870 [debug] [MainThread]: Using postgres connection "debug"
[0m16:32:49.589870 [debug] [MainThread]: On debug: select 1 as id
[0m16:32:49.589870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:50.115103 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m16:32:50.117101 [debug] [MainThread]: On debug: Close
[0m16:32:50.117101 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:32:50.119104 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:32:50.121103 [debug] [MainThread]: Command `dbt debug` succeeded at 16:32:50.121103 after 0.87 seconds
[0m16:32:50.121103 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:32:50.122104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE2321790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE8AACD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BE260BA50>]}
[0m16:32:50.123147 [debug] [MainThread]: Flushing usage events
[0m16:33:12.630640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C25A8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C25A9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C25AB550>]}


============================== 16:33:12.634697 | 6d795774-95b0-45a1-83f9-bbc176c5b0c8 ==============================
[0m16:33:12.634697 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:33:12.636057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --models source:adw', 'send_anonymous_usage_stats': 'True'}
[0m16:33:12.851470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d795774-95b0-45a1-83f9-bbc176c5b0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C26FEE90>]}
[0m16:33:12.932528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d795774-95b0-45a1-83f9-bbc176c5b0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C0E8D510>]}
[0m16:33:12.934577 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:33:12.943870 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:33:13.014807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:13.015813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:13.022365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d795774-95b0-45a1-83f9-bbc176c5b0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C29423D0>]}
[0m16:33:13.036337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d795774-95b0-45a1-83f9-bbc176c5b0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C28B2BD0>]}
[0m16:33:13.037343 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:33:13.037343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d795774-95b0-45a1-83f9-bbc176c5b0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C2849450>]}
[0m16:33:13.039758 [info ] [MainThread]: 
[0m16:33:13.040759 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:33:13.040759 [debug] [MainThread]: Command end result
[0m16:33:13.051264 [debug] [MainThread]: Command `dbt test` succeeded at 16:33:13.051264 after 0.49 seconds
[0m16:33:13.052270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BB7C1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C126B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9BBA56710>]}
[0m16:33:13.053776 [debug] [MainThread]: Flushing usage events
[0m16:36:40.597363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE52C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE1756D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE527C50>]}


============================== 16:36:40.602371 | a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9 ==============================
[0m16:36:40.602371 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:36:40.603374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_sales_header', 'send_anonymous_usage_stats': 'True'}
[0m16:36:40.812912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE666E90>]}
[0m16:36:40.908391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE154E10>]}
[0m16:36:40.909822 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:36:40.918867 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:36:40.995392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:40.995392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:41.003894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE798410>]}
[0m16:36:41.020182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE7C2CD0>]}
[0m16:36:41.021479 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:36:41.022509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE571B50>]}
[0m16:36:41.024514 [info ] [MainThread]: 
[0m16:36:41.025518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:41.027628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:36:41.042475 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:36:41.043925 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:36:41.046327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:41.605127 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:36:41.607124 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:36:41.610087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_dbt'
[0m16:36:41.616093 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:36:41.616093 [debug] [ThreadPool]: On list_adventureworks2022_dbt: BEGIN
[0m16:36:41.617092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:42.099644 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:36:42.100642 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:36:42.101642 [debug] [ThreadPool]: On list_adventureworks2022_dbt: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_dbt"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:36:42.156625 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:36:42.158627 [debug] [ThreadPool]: On list_adventureworks2022_dbt: ROLLBACK
[0m16:36:42.211296 [debug] [ThreadPool]: On list_adventureworks2022_dbt: Close
[0m16:36:42.216454 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:42.217430 [debug] [MainThread]: On master: BEGIN
[0m16:36:42.217430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:42.813503 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:36:42.814518 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:42.816439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:42.885593 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:36:42.887589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE67C490>]}
[0m16:36:42.888591 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:42.950497 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:42.950497 [debug] [MainThread]: On master: BEGIN
[0m16:36:43.074480 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:36:43.074480 [debug] [MainThread]: On master: COMMIT
[0m16:36:43.075478 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:43.075478 [debug] [MainThread]: On master: COMMIT
[0m16:36:43.137198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:36:43.137198 [debug] [MainThread]: On master: Close
[0m16:36:43.138209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:43.139208 [info ] [MainThread]: 
[0m16:36:43.142219 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:36:43.143312 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.stg_sales_header ............................... [RUN]
[0m16:36:43.145215 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:36:43.146215 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:36:43.158900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:36:43.159908 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:36:43.146215 => 16:36:43.159908
[0m16:36:43.160908 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:36:43.207905 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:36:43.208908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:36:43.209908 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:36:43.209908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:43.703751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:36:43.704750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:36:43.705752 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."dbt"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        SalesOrderID,
        CustomerID,
        OrderDate,
        TotalDue
    from "adventureworks2022"."adw"."sales_header"
)
select * from sales_header;
  );
[0m16:36:43.759289 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:36:43.761289 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:36:43.815276 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:36:43.160908 => 16:36:43.814066
[0m16:36:43.816363 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:36:43.825352 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:36:43.825352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0e3b853-9cdd-4d75-adf7-4fa48e7a88f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BE737C90>]}
[0m16:36:43.826275 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt.stg_sales_header ...................... [[31mERROR[0m in 0.68s]
[0m16:36:43.827263 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:36:43.830301 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:43.830301 [debug] [MainThread]: On master: BEGIN
[0m16:36:43.831264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:44.332035 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:36:44.333144 [debug] [MainThread]: On master: COMMIT
[0m16:36:44.334060 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:44.335341 [debug] [MainThread]: On master: COMMIT
[0m16:36:44.389927 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:36:44.391035 [debug] [MainThread]: On master: Close
[0m16:36:44.393990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:44.393990 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:36:44.395033 [debug] [MainThread]: Connection 'list_adventureworks2022_dbt' was properly closed.
[0m16:36:44.395033 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_header' was properly closed.
[0m16:36:44.396264 [info ] [MainThread]: 
[0m16:36:44.397275 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m16:36:44.398275 [debug] [MainThread]: Command end result
[0m16:36:44.408371 [info ] [MainThread]: 
[0m16:36:44.409279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:44.410275 [info ] [MainThread]: 
[0m16:36:44.411318 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:36:44.412321 [info ] [MainThread]: 
[0m16:36:44.413323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:36:44.415356 [debug] [MainThread]: Command `dbt run` failed at 16:36:44.414308 after 3.88 seconds
[0m16:36:44.415356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238B77317D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238B7773010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238B7772490>]}
[0m16:36:44.416278 [debug] [MainThread]: Flushing usage events
[0m16:37:13.720016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4094EA350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4094E8E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4094E9A50>]}


============================== 16:37:13.724987 | e6e0bafa-5862-459a-891f-a50bf1b327b2 ==============================
[0m16:37:13.724987 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:37:13.725987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_sales_headerorder_detail', 'send_anonymous_usage_stats': 'True'}
[0m16:37:13.938219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e0bafa-5862-459a-891f-a50bf1b327b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A409542550>]}
[0m16:37:14.027517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e0bafa-5862-459a-891f-a50bf1b327b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40893C910>]}
[0m16:37:14.029584 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:37:14.038655 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:37:14.105226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:14.105226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:14.111826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e0bafa-5862-459a-891f-a50bf1b327b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4098BAB10>]}
[0m16:37:14.124035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e0bafa-5862-459a-891f-a50bf1b327b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4097F8690>]}
[0m16:37:14.125040 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:37:14.126056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e0bafa-5862-459a-891f-a50bf1b327b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A40976AA50>]}
[0m16:37:14.127042 [warn ] [MainThread]: The selection criterion 'stg_sales_headerorder_detail' does not match any nodes
[0m16:37:14.127930 [info ] [MainThread]: 
[0m16:37:14.129521 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:37:14.130528 [debug] [MainThread]: Command end result
[0m16:37:14.139229 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:14.139229 after 0.48 seconds
[0m16:37:14.139229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A4027417D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A402A34410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A409611410>]}
[0m16:37:14.140744 [debug] [MainThread]: Flushing usage events
[0m16:37:34.486619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF4809010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF4808F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF480B5D0>]}


============================== 16:37:34.490628 | 5dfa7e38-c8d2-43da-8679-b5e0bfd089e2 ==============================
[0m16:37:34.490628 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:37:34.491629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_sales_order_detail', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:34.686936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dfa7e38-c8d2-43da-8679-b5e0bfd089e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF485BB10>]}
[0m16:37:34.777876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dfa7e38-c8d2-43da-8679-b5e0bfd089e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF4931F90>]}
[0m16:37:34.779493 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:37:34.786671 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:37:34.850130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:34.851130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:34.855899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dfa7e38-c8d2-43da-8679-b5e0bfd089e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF3C56150>]}
[0m16:37:34.869478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dfa7e38-c8d2-43da-8679-b5e0bfd089e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF495E6D0>]}
[0m16:37:34.869478 [info ] [MainThread]: Found 5 models, 6 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:37:34.871840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfa7e38-c8d2-43da-8679-b5e0bfd089e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF49F6810>]}
[0m16:37:34.872893 [info ] [MainThread]: 
[0m16:37:34.873862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:34.875813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:37:34.885840 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:37:34.886848 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:37:34.887957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:35.409060 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:37:35.411124 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:37:35.415132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_dbt'
[0m16:37:35.421249 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:37:35.421249 [debug] [ThreadPool]: On list_adventureworks2022_dbt: BEGIN
[0m16:37:35.422133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:35.918575 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:37:35.920595 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_dbt"
[0m16:37:35.921607 [debug] [ThreadPool]: On list_adventureworks2022_dbt: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_dbt"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt'
  
[0m16:37:35.977296 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:37:35.980302 [debug] [ThreadPool]: On list_adventureworks2022_dbt: ROLLBACK
[0m16:37:36.031739 [debug] [ThreadPool]: On list_adventureworks2022_dbt: Close
[0m16:37:36.038736 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:36.038736 [debug] [MainThread]: On master: BEGIN
[0m16:37:36.039736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:36.525012 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:37:36.527035 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:36.527999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:36.584002 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:37:36.586000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfa7e38-c8d2-43da-8679-b5e0bfd089e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF4AC9350>]}
[0m16:37:36.586000 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:36.638070 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:36.639069 [debug] [MainThread]: On master: BEGIN
[0m16:37:36.741858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:37:36.741858 [debug] [MainThread]: On master: COMMIT
[0m16:37:36.742937 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:36.742937 [debug] [MainThread]: On master: COMMIT
[0m16:37:36.795219 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:37:36.797220 [debug] [MainThread]: On master: Close
[0m16:37:36.799253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:36.800215 [info ] [MainThread]: 
[0m16:37:36.806216 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:37:36.806216 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt.stg_sales_order_detail ......................... [RUN]
[0m16:37:36.808728 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_order_detail'
[0m16:37:36.809905 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m16:37:36.820124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:37:36.822044 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 16:37:36.809905 => 16:37:36.822044
[0m16:37:36.822044 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m16:37:36.867921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:37:36.869833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:37:36.869833 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m16:37:36.870836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:37:37.530458 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:37:37.531459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:37:37.532458 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."dbt"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        SalesOrderDetailID,
        SalesOrderID,
        ProductID,
        OrderQty,
        UnitPrice,
        OrderQty * UnitPrice as TotalPrice
    from "adventureworks2022"."adw"."sales_order_detail"
)
select * from sales_order_detail;
  );
[0m16:37:37.613842 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: select * from sales_order_detail;
                                         ^

[0m16:37:37.614873 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: ROLLBACK
[0m16:37:37.685586 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 16:37:36.822044 => 16:37:37.684554
[0m16:37:37.685586 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m16:37:37.691083 [debug] [Thread-1 (]: Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:37:37.692143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfa7e38-c8d2-43da-8679-b5e0bfd089e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF4CBA090>]}
[0m16:37:37.692143 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt.stg_sales_order_detail ................ [[31mERROR[0m in 0.88s]
[0m16:37:37.694080 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:37:37.696602 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:37.697700 [debug] [MainThread]: On master: BEGIN
[0m16:37:37.698605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:38.275905 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:37:38.277829 [debug] [MainThread]: On master: COMMIT
[0m16:37:38.279526 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:38.280604 [debug] [MainThread]: On master: COMMIT
[0m16:37:38.343024 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:37:38.344086 [debug] [MainThread]: On master: Close
[0m16:37:38.345676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:38.345676 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:37:38.346689 [debug] [MainThread]: Connection 'list_adventureworks2022_dbt' was properly closed.
[0m16:37:38.346689 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_order_detail' was properly closed.
[0m16:37:38.347790 [info ] [MainThread]: 
[0m16:37:38.348688 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m16:37:38.349687 [debug] [MainThread]: Command end result
[0m16:37:38.359815 [info ] [MainThread]: 
[0m16:37:38.362833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:37:38.363400 [info ] [MainThread]: 
[0m16:37:38.364655 [error] [MainThread]:   Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:37:38.365846 [info ] [MainThread]: 
[0m16:37:38.366854 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:37:38.368387 [debug] [MainThread]: Command `dbt run` failed at 16:37:38.368387 after 3.95 seconds
[0m16:37:38.368387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DEDA517D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DF49DB150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DEDD44410>]}
[0m16:37:38.369388 [debug] [MainThread]: Flushing usage events
[0m16:46:48.053926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D7C9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D7CAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D7CB6D0>]}


============================== 16:46:48.058929 | 4682175d-3a55-4602-b1bb-e79695c40551 ==============================
[0m16:46:48.058929 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:46:48.059927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_sales_headerorder_detail', 'send_anonymous_usage_stats': 'True'}
[0m16:46:48.268936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4682175d-3a55-4602-b1bb-e79695c40551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D9C9390>]}
[0m16:46:48.353716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4682175d-3a55-4602-b1bb-e79695c40551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D9CFD90>]}
[0m16:46:48.355152 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:46:48.364245 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:46:48.476754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:46:48.477754 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m16:46:48.478749 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:46:48.478749 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_detail.sql
[0m16:46:48.479747 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m16:46:48.767636 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_etl_adw.stg_sales_header' (models\staging\stg_sales_header.sql) depends on a source named 'adw.salesorderheader' which was not found
[0m16:46:48.769635 [debug] [MainThread]: Command `dbt run` failed at 16:46:48.769635 after 0.79 seconds
[0m16:46:48.770723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7D837690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC7DD54AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC76A617D0>]}
[0m16:46:48.770723 [debug] [MainThread]: Flushing usage events
[0m16:47:27.272711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78742B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D787091E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78743EA50>]}


============================== 16:47:27.276288 | 05d6c1d1-7182-4d57-a8d4-77c6ba34dfe3 ==============================
[0m16:47:27.276288 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:47:27.278566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_sales_header', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:27.501991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05d6c1d1-7182-4d57-a8d4-77c6ba34dfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7875C4310>]}
[0m16:47:27.593531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05d6c1d1-7182-4d57-a8d4-77c6ba34dfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7874B0250>]}
[0m16:47:27.595515 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:47:27.604227 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:47:27.667784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:47:27.668784 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m16:47:27.669738 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:47:27.669738 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_detail.sql
[0m16:47:27.670747 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m16:47:27.956539 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_etl_adw.stg_sales_header' (models\staging\stg_sales_header.sql) depends on a source named 'adw.salesorderheader' which was not found
[0m16:47:27.958540 [debug] [MainThread]: Command `dbt run` failed at 16:47:27.958540 after 0.75 seconds
[0m16:47:27.959539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78747B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D787968090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7806E17D0>]}
[0m16:47:27.959539 [debug] [MainThread]: Flushing usage events
[0m16:50:46.076764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E15881D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E1588CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E15891D0>]}


============================== 16:50:46.082315 | d7064a79-294e-447c-baaf-16894e70afab ==============================
[0m16:50:46.082315 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:50:46.082315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:46.083822 [info ] [MainThread]: dbt version: 1.7.11
[0m16:50:46.084829 [info ] [MainThread]: python version: 3.11.5
[0m16:50:46.085830 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m16:50:46.086829 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m16:50:46.196015 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m16:50:46.196015 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m16:50:46.197520 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m16:50:46.198938 [info ] [MainThread]: adapter type: postgres
[0m16:50:46.199944 [info ] [MainThread]: adapter version: 1.7.11
[0m16:50:46.278012 [info ] [MainThread]: Configuration:
[0m16:50:46.279697 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:50:46.279697 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:50:46.281203 [info ] [MainThread]: Required dependencies:
[0m16:50:46.282211 [debug] [MainThread]: Executing "git --help"
[0m16:50:46.320388 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:50:46.320388 [debug] [MainThread]: STDERR: "b''"
[0m16:50:46.321390 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:50:46.322353 [info ] [MainThread]: Connection:
[0m16:50:46.323351 [info ] [MainThread]:   host: aws-adw.czmo6y6u8ehp.ap-southeast-1.rds.amazonaws.com
[0m16:50:46.324861 [info ] [MainThread]:   port: 5432
[0m16:50:46.324861 [info ] [MainThread]:   user: postgres
[0m16:50:46.326872 [info ] [MainThread]:   database: adventureworks2022
[0m16:50:46.327912 [info ] [MainThread]:   schema: dbt
[0m16:50:46.328868 [info ] [MainThread]:   connect_timeout: 10
[0m16:50:46.328868 [info ] [MainThread]:   role: None
[0m16:50:46.331437 [info ] [MainThread]:   search_path: None
[0m16:50:46.332523 [info ] [MainThread]:   keepalives_idle: 0
[0m16:50:46.333530 [info ] [MainThread]:   sslmode: None
[0m16:50:46.333530 [info ] [MainThread]:   sslcert: None
[0m16:50:46.334529 [info ] [MainThread]:   sslkey: None
[0m16:50:46.334529 [info ] [MainThread]:   sslrootcert: None
[0m16:50:46.336036 [info ] [MainThread]:   application_name: dbt
[0m16:50:46.336036 [info ] [MainThread]:   retries: 1
[0m16:50:46.336994 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:50:46.338002 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:50:46.338002 [debug] [MainThread]: Using postgres connection "debug"
[0m16:50:46.338002 [debug] [MainThread]: On debug: select 1 as id
[0m16:50:46.339265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:47.043132 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m16:50:47.044131 [debug] [MainThread]: On debug: Close
[0m16:50:47.045133 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:50:47.046132 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:50:47.047559 [debug] [MainThread]: Command `dbt debug` succeeded at 16:50:47.047559 after 1.04 seconds
[0m16:50:47.047559 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:50:47.048563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DA7F1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DAAD8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E11E15D0>]}
[0m16:50:47.048563 [debug] [MainThread]: Flushing usage events
[0m16:51:08.278684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4058C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D405AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4059310>]}


============================== 16:51:08.283684 | 7822dfad-ca8c-448d-9421-31224bbbc1be ==============================
[0m16:51:08.283684 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:51:08.284685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:51:08.490576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7822dfad-ca8c-448d-9421-31224bbbc1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4098DD0>]}
[0m16:51:08.582914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7822dfad-ca8c-448d-9421-31224bbbc1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D41A4150>]}
[0m16:51:08.584834 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:51:08.593918 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:51:08.606244 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:51:08.607150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7822dfad-ca8c-448d-9421-31224bbbc1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D41FE150>]}
[0m16:51:09.537300 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_sales_order_details' in the 'models' section of file 'models\staging\schema.yml'
[0m16:51:09.717271 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_etl_adw.stg_sales_header' (models\staging\stg_sales_header.sql) depends on a source named 'adw.salesorderheader' which was not found
[0m16:51:09.719792 [debug] [MainThread]: Command `dbt run` failed at 16:51:09.719792 after 1.52 seconds
[0m16:51:09.720792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D40B0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184CD331790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D405A390>]}
[0m16:51:09.721791 [debug] [MainThread]: Flushing usage events
[0m16:52:20.669544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F2A16FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F2A16C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F2A17F10>]}


============================== 16:52:20.674179 | f672a90b-c9d7-4073-a21e-7d94d7300049 ==============================
[0m16:52:20.674179 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:52:20.675099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:52:20.676605 [info ] [MainThread]: dbt version: 1.7.11
[0m16:52:20.677612 [info ] [MainThread]: python version: 3.11.5
[0m16:52:20.679027 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m16:52:20.680045 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m16:52:20.786983 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m16:52:20.788989 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m16:52:20.788989 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m16:52:20.790993 [info ] [MainThread]: adapter type: postgres
[0m16:52:20.792495 [info ] [MainThread]: adapter version: 1.7.11
[0m16:52:20.867115 [info ] [MainThread]: Configuration:
[0m16:52:20.868459 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:52:20.869546 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:52:20.870468 [info ] [MainThread]: Required dependencies:
[0m16:52:20.871464 [debug] [MainThread]: Executing "git --help"
[0m16:52:20.907126 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:52:20.908157 [debug] [MainThread]: STDERR: "b''"
[0m16:52:20.908157 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:52:20.909662 [info ] [MainThread]: Connection:
[0m16:52:20.910687 [info ] [MainThread]:   host: aws-adw.czmo6y6u8ehp.ap-southeast-1.rds.amazonaws.com
[0m16:52:20.911994 [info ] [MainThread]:   port: 5432
[0m16:52:20.911994 [info ] [MainThread]:   user: postgres
[0m16:52:20.912994 [info ] [MainThread]:   database: adventureworks2022
[0m16:52:20.913987 [info ] [MainThread]:   schema: public
[0m16:52:20.914990 [info ] [MainThread]:   connect_timeout: 10
[0m16:52:20.915988 [info ] [MainThread]:   role: None
[0m16:52:20.918175 [info ] [MainThread]:   search_path: None
[0m16:52:20.919083 [info ] [MainThread]:   keepalives_idle: 0
[0m16:52:20.919950 [info ] [MainThread]:   sslmode: None
[0m16:52:20.919950 [info ] [MainThread]:   sslcert: None
[0m16:52:20.921527 [info ] [MainThread]:   sslkey: None
[0m16:52:20.922535 [info ] [MainThread]:   sslrootcert: None
[0m16:52:20.922535 [info ] [MainThread]:   application_name: dbt
[0m16:52:20.923556 [info ] [MainThread]:   retries: 1
[0m16:52:20.924595 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:52:20.924595 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:52:20.925564 [debug] [MainThread]: Using postgres connection "debug"
[0m16:52:20.925564 [debug] [MainThread]: On debug: select 1 as id
[0m16:52:20.925564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:21.449377 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m16:52:21.450347 [debug] [MainThread]: On debug: Close
[0m16:52:21.451347 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:52:21.452320 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:52:21.454400 [debug] [MainThread]: Command `dbt debug` succeeded at 16:52:21.454400 after 0.85 seconds
[0m16:52:21.454400 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:52:21.455401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3EBC01790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3EBEEBA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F1637510>]}
[0m16:52:21.456401 [debug] [MainThread]: Flushing usage events
[0m16:54:37.178137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360468C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360476C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360468D50>]}


============================== 16:54:37.183247 | c67380ef-29a8-4c00-bf94-b172a3c06795 ==============================
[0m16:54:37.183247 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:54:37.184257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models stg_sales_header', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:54:37.377302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3604E8390>]}
[0m16:54:37.460272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3605B6C90>]}
[0m16:54:37.461194 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:54:37.471243 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:54:37.483880 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:54:37.483880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B35F8C3E90>]}
[0m16:54:38.623345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3608B4090>]}
[0m16:54:38.635347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360866650>]}
[0m16:54:38.636345 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:54:38.637352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360A96ED0>]}
[0m16:54:38.639346 [info ] [MainThread]: 
[0m16:54:38.640347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:38.642351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:54:38.655725 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:54:38.655725 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:54:38.656725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:39.246481 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:54:39.248482 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:54:39.250483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m16:54:39.257993 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:54:39.257993 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m16:54:39.258993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:39.893326 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:54:39.894334 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:54:39.895337 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:54:39.967666 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:54:39.971790 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m16:54:40.038189 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m16:54:40.043191 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:40.044191 [debug] [MainThread]: On master: BEGIN
[0m16:54:40.044191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:40.611757 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:54:40.611757 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:40.612754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:54:40.683153 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:54:40.684152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360928DD0>]}
[0m16:54:40.685148 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:40.758891 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:40.759894 [debug] [MainThread]: On master: BEGIN
[0m16:54:40.877000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:54:40.877000 [debug] [MainThread]: On master: COMMIT
[0m16:54:40.877993 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:40.877993 [debug] [MainThread]: On master: COMMIT
[0m16:54:40.937282 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:54:40.938309 [debug] [MainThread]: On master: Close
[0m16:54:40.941301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:40.943303 [info ] [MainThread]: 
[0m16:54:40.950881 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:54:40.951956 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales_header ............................ [RUN]
[0m16:54:40.953886 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:54:40.954884 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:54:40.963884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:54:40.964948 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:54:40.954884 => 16:54:40.964948
[0m16:54:40.965935 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:54:41.002654 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:54:41.003658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:54:41.004575 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:54:41.004575 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:41.661992 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:54:41.663992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:54:41.664991 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from "adventureworks2022"."public"."salesorderheader"
)
select * from sales_header;
  );
[0m16:54:41.733713 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:54:41.735599 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:54:41.804686 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:54:40.965935 => 16:54:41.803581
[0m16:54:41.805680 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:54:41.812305 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:54:41.813294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67380ef-29a8-4c00-bf94-b172a3c06795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360B2D310>]}
[0m16:54:41.814209 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_sales_header ................... [[31mERROR[0m in 0.86s]
[0m16:54:41.815207 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:54:41.817209 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:41.818290 [debug] [MainThread]: On master: BEGIN
[0m16:54:41.818290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:42.310029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:54:42.311019 [debug] [MainThread]: On master: COMMIT
[0m16:54:42.311609 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:42.311609 [debug] [MainThread]: On master: COMMIT
[0m16:54:42.364378 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:54:42.365515 [debug] [MainThread]: On master: Close
[0m16:54:42.365515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:42.367143 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:54:42.367143 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m16:54:42.368154 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_header' was properly closed.
[0m16:54:42.369153 [info ] [MainThread]: 
[0m16:54:42.369881 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m16:54:42.372117 [debug] [MainThread]: Command end result
[0m16:54:42.381112 [info ] [MainThread]: 
[0m16:54:42.382163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:42.383115 [info ] [MainThread]: 
[0m16:54:42.384114 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:54:42.385113 [info ] [MainThread]: 
[0m16:54:42.386114 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:42.388113 [debug] [MainThread]: Command `dbt run` failed at 16:54:42.388113 after 5.28 seconds
[0m16:54:42.388113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3596C17D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B360856A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3604C1D90>]}
[0m16:54:42.390621 [debug] [MainThread]: Flushing usage events
[0m16:55:07.478170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B017EEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7E422D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0179A850>]}


============================== 16:55:07.482210 | 77eb335b-fb2b-4894-9477-a315c7faa9b3 ==============================
[0m16:55:07.482210 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:55:07.484132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init dbt_etl_adw', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:07.487212 [info ] [MainThread]: Setting up your profile.
[0m16:55:20.165014 [debug] [MainThread]: Command `dbt init` succeeded at 16:55:20.163722 after 12.75 seconds
[0m16:55:20.165014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7A961810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B017DE590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B7A9A3010>]}
[0m16:55:20.166328 [debug] [MainThread]: Flushing usage events
[0m16:55:28.930940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E02AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272DB28690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E02B0D0>]}


============================== 16:55:28.934907 | 35ebb0a8-470a-4fc3-adf0-dcbd3f715181 ==============================
[0m16:55:28.934907 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:55:28.935902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:29.126548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E16BD90>]}
[0m16:55:29.222916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E16BFD0>]}
[0m16:55:29.224836 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:55:29.234722 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:55:29.322775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:29.323775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:29.331049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272B0A59D0>]}
[0m16:55:29.345050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E32FE50>]}
[0m16:55:29.346051 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:55:29.347045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E1CEC10>]}
[0m16:55:29.349045 [info ] [MainThread]: 
[0m16:55:29.350043 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:29.353046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:55:29.366568 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:55:29.366568 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:55:29.367552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:29.959629 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:55:29.962297 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:55:29.966731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m16:55:29.974066 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:55:29.975063 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m16:55:29.975063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:30.539867 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:55:30.540873 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:55:30.541873 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:55:30.636234 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:55:30.638239 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m16:55:30.697809 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m16:55:30.703311 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:30.703918 [debug] [MainThread]: On master: BEGIN
[0m16:55:30.703918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:31.274736 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:55:31.276734 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:31.278749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:31.343243 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:55:31.347263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E1B73D0>]}
[0m16:55:31.348267 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:31.408673 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:31.408673 [debug] [MainThread]: On master: BEGIN
[0m16:55:31.527754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:55:31.527754 [debug] [MainThread]: On master: COMMIT
[0m16:55:31.528754 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:31.528754 [debug] [MainThread]: On master: COMMIT
[0m16:55:31.588581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:55:31.589586 [debug] [MainThread]: On master: Close
[0m16:55:31.590585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:31.591583 [info ] [MainThread]: 
[0m16:55:31.595504 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:55:31.596502 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m16:55:31.598505 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:55:31.598505 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:55:31.607704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:55:31.608802 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:55:31.599597 => 16:55:31.608802
[0m16:55:31.609755 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:55:31.649503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:55:31.650518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:55:31.651516 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:55:31.651516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:32.220617 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:55:32.220617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:55:32.221709 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from "adventureworks2022"."public"."salesorderheader"
)
select * from sales_header;
  );
[0m16:55:32.282280 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:55:32.284453 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:55:32.344808 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:55:31.610744 => 16:55:32.344808
[0m16:55:32.345907 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:55:32.350938 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:55:32.351910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E4DED10>]}
[0m16:55:32.351910 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model public.stg_sales_header ................... [[31mERROR[0m in 0.75s]
[0m16:55:32.353835 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:55:32.353835 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:55:32.354916 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m16:55:32.356862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m16:55:32.356862 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m16:55:32.359910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:55:32.360825 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 16:55:32.356862 => 16:55:32.360825
[0m16:55:32.361826 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m16:55:32.366433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:55:32.367428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:55:32.368338 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m16:55:32.368338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:32.985847 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:55:32.986837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:55:32.986837 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderDetailID",
        "SalesOrderID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from "adventureworks2022"."public"."salesorderdetail"
)
select * from sales_order_detail;
  );
[0m16:55:33.053769 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: select * from sales_order_detail;
                                         ^

[0m16:55:33.055786 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: ROLLBACK
[0m16:55:33.123452 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 16:55:32.362331 => 16:55:33.122451
[0m16:55:33.124451 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m16:55:33.129578 [debug] [Thread-1 (]: Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:55:33.129578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35ebb0a8-470a-4fc3-adf0-dcbd3f715181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E4DFD10>]}
[0m16:55:33.130581 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model public.stg_sales_order_detail ............. [[31mERROR[0m in 0.77s]
[0m16:55:33.132582 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:55:33.133626 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m16:55:33.133626 [info ] [Thread-1 (]: 3 of 5 SKIP relation public.trans_sales_orders ................................. [[33mSKIP[0m]
[0m16:55:33.134651 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m16:55:33.135577 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m16:55:33.136577 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m16:55:33.137577 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m16:55:33.138577 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m16:55:33.139577 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m16:55:33.140579 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m16:55:33.142915 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:33.143421 [debug] [MainThread]: On master: BEGIN
[0m16:55:33.143421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:33.668219 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:55:33.669220 [debug] [MainThread]: On master: COMMIT
[0m16:55:33.669220 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:33.670223 [debug] [MainThread]: On master: COMMIT
[0m16:55:33.724302 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:55:33.724302 [debug] [MainThread]: On master: Close
[0m16:55:33.726319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:33.726319 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:55:33.726319 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m16:55:33.727301 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_order_detail' was properly closed.
[0m16:55:33.727301 [info ] [MainThread]: 
[0m16:55:33.728307 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m16:55:33.729309 [debug] [MainThread]: Command end result
[0m16:55:33.738306 [info ] [MainThread]: 
[0m16:55:33.739308 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:55:33.740555 [info ] [MainThread]: 
[0m16:55:33.741563 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:55:33.742904 [info ] [MainThread]: 
[0m16:55:33.743958 [error] [MainThread]:   Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:55:33.744911 [info ] [MainThread]: 
[0m16:55:33.746913 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m16:55:33.750914 [debug] [MainThread]: Command `dbt run` failed at 16:55:33.750002 after 4.88 seconds
[0m16:55:33.750914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022727231790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E029E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002272E02A750>]}
[0m16:55:33.752390 [debug] [MainThread]: Flushing usage events
[0m16:57:42.589942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EFD6A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EFD6B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EFD6A950>]}


============================== 16:57:42.596658 | 61389500-fcf5-4944-8e15-e85bb28d1f67 ==============================
[0m16:57:42.596658 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:57:42.598657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:57:42.798400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EFDE8610>]}
[0m16:57:42.879101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EFEB5190>]}
[0m16:57:42.881127 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:57:42.889188 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:57:42.975563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:57:42.976663 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:57:42.977654 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_detail.sql
[0m16:57:43.258823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F02F40D0>]}
[0m16:57:43.273147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F0151ED0>]}
[0m16:57:43.274147 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:57:43.275148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F002B5D0>]}
[0m16:57:43.276410 [info ] [MainThread]: 
[0m16:57:43.278421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:57:43.280417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:57:43.293182 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:57:43.294081 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:57:43.294081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:43.884086 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:57:43.888103 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:57:43.893115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m16:57:43.901179 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:57:43.901179 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m16:57:43.902135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:44.473176 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:57:44.474171 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:57:44.475171 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:57:44.538628 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:57:44.539624 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m16:57:44.602119 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m16:57:44.612368 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:44.613369 [debug] [MainThread]: On master: BEGIN
[0m16:57:44.614368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:45.200542 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:57:45.201541 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:45.202542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:57:45.268913 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:57:45.272434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F02B2A10>]}
[0m16:57:45.273454 [debug] [MainThread]: On master: ROLLBACK
[0m16:57:45.335717 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:45.336808 [debug] [MainThread]: On master: BEGIN
[0m16:57:45.459879 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:57:45.460900 [debug] [MainThread]: On master: COMMIT
[0m16:57:45.461890 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:45.461890 [debug] [MainThread]: On master: COMMIT
[0m16:57:45.523752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:57:45.525772 [debug] [MainThread]: On master: Close
[0m16:57:45.527292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:45.528292 [info ] [MainThread]: 
[0m16:57:45.533626 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:57:45.534551 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m16:57:45.535615 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:57:45.537219 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:57:45.541322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:57:45.544860 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:57:45.537219 => 16:57:45.543858
[0m16:57:45.546968 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:57:45.586478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:57:45.586478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:57:45.587985 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:57:45.589002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:57:46.095888 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:57:46.096868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:57:46.096868 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header;
  );
[0m16:57:46.149563 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from sales_header;
                                   ^

[0m16:57:46.149563 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: ROLLBACK
[0m16:57:46.203457 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:57:45.548477 => 16:57:46.202153
[0m16:57:46.204468 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:57:46.211590 [debug] [Thread-1 (]: Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:57:46.213678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F04A9750>]}
[0m16:57:46.214694 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model public.stg_sales_header ................... [[31mERROR[0m in 0.68s]
[0m16:57:46.215597 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:57:46.216638 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:57:46.216638 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m16:57:46.219474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m16:57:46.219474 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m16:57:46.221559 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:57:46.222517 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 16:57:46.220474 => 16:57:46.222517
[0m16:57:46.223473 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m16:57:46.227121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:57:46.227121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:57:46.228671 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m16:57:46.228671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:46.876647 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:57:46.878750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:57:46.879744 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderDetailID",
        "SalesOrderID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail;
  );
[0m16:57:46.950175 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: select * from sales_order_detail;
                                         ^

[0m16:57:46.952289 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: ROLLBACK
[0m16:57:47.023340 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 16:57:46.223473 => 16:57:47.022317
[0m16:57:47.024337 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m16:57:47.029323 [debug] [Thread-1 (]: Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:57:47.029323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61389500-fcf5-4944-8e15-e85bb28d1f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257F03E0310>]}
[0m16:57:47.030324 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model public.stg_sales_order_detail ............. [[31mERROR[0m in 0.81s]
[0m16:57:47.032327 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:57:47.033325 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m16:57:47.034324 [info ] [Thread-1 (]: 3 of 5 SKIP relation public.trans_sales_orders ................................. [[33mSKIP[0m]
[0m16:57:47.035328 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m16:57:47.036327 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m16:57:47.037840 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m16:57:47.038846 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m16:57:47.039847 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m16:57:47.039847 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m16:57:47.041848 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m16:57:47.042850 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:47.043848 [debug] [MainThread]: On master: BEGIN
[0m16:57:47.044849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:47.679466 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:57:47.680561 [debug] [MainThread]: On master: COMMIT
[0m16:57:47.680561 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:47.681458 [debug] [MainThread]: On master: COMMIT
[0m16:57:47.748311 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:57:47.748311 [debug] [MainThread]: On master: Close
[0m16:57:47.749368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:47.750294 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:57:47.750294 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m16:57:47.750294 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_order_detail' was properly closed.
[0m16:57:47.751757 [info ] [MainThread]: 
[0m16:57:47.752767 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m16:57:47.754764 [debug] [MainThread]: Command end result
[0m16:57:47.764368 [info ] [MainThread]: 
[0m16:57:47.765377 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:57:47.766377 [info ] [MainThread]: 
[0m16:57:47.767375 [error] [MainThread]:   Database Error in model stg_sales_header (models\staging\stg_sales_header.sql)
  syntax error at or near ";"
  LINE 15: select * from sales_header;
                                     ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_header.sql
[0m16:57:47.768376 [info ] [MainThread]: 
[0m16:57:47.769375 [error] [MainThread]:   Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:57:47.770381 [info ] [MainThread]: 
[0m16:57:47.771749 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
[0m16:57:47.776248 [debug] [MainThread]: Command `dbt run` failed at 16:57:47.776248 after 5.26 seconds
[0m16:57:47.777189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257E8F71790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EF864190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257EF9B5410>]}
[0m16:57:47.778252 [debug] [MainThread]: Flushing usage events
[0m16:58:15.572731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270470AB210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704709B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027047099B90>]}


============================== 16:58:15.577739 | c99889c1-1dd3-4980-b2cb-e43d2f945dc8 ==============================
[0m16:58:15.577739 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:58:15.578739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:58:15.806251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270472A09D0>]}
[0m16:58:15.917465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270471CA790>]}
[0m16:58:15.918468 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:58:15.930475 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:58:16.022012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:16.023014 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m16:58:16.317266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027047547ED0>]}
[0m16:58:16.335318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027047481B50>]}
[0m16:58:16.336317 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:58:16.337316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270472A0490>]}
[0m16:58:16.339854 [info ] [MainThread]: 
[0m16:58:16.340854 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:58:16.344866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m16:58:16.361349 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m16:58:16.362349 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m16:58:16.362349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:16.871154 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:58:16.874153 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m16:58:16.878152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m16:58:16.892170 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:58:16.894158 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m16:58:16.895158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:17.469488 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:58:17.470399 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m16:58:17.471518 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:58:17.538586 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:58:17.540090 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m16:58:17.607569 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m16:58:17.615397 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:17.616713 [debug] [MainThread]: On master: BEGIN
[0m16:58:17.616713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:18.182677 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:58:18.183682 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:18.183682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:58:18.248741 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:58:18.249838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270475D8D90>]}
[0m16:58:18.250829 [debug] [MainThread]: On master: ROLLBACK
[0m16:58:18.310933 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:18.312099 [debug] [MainThread]: On master: BEGIN
[0m16:58:18.431352 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:58:18.432353 [debug] [MainThread]: On master: COMMIT
[0m16:58:18.433354 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:18.434353 [debug] [MainThread]: On master: COMMIT
[0m16:58:18.494372 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:58:18.495370 [debug] [MainThread]: On master: Close
[0m16:58:18.497882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:18.498880 [info ] [MainThread]: 
[0m16:58:18.502881 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m16:58:18.503881 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m16:58:18.505884 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m16:58:18.506882 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m16:58:18.516881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m16:58:18.519872 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 16:58:18.507882 => 16:58:18.518864
[0m16:58:18.520871 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m16:58:18.577215 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m16:58:18.579217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:58:18.580573 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m16:58:18.580573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:58:19.158720 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:58:19.159725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:58:19.159725 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m16:58:19.227998 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:58:19.236684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:58:19.237758 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m16:58:19.300769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:58:19.313463 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m16:58:19.314460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:58:19.315463 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m16:58:19.377475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:58:19.385793 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m16:58:19.391792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m16:58:19.392793 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m16:58:19.454536 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:58:19.457500 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 16:58:18.520871 => 16:58:19.456502
[0m16:58:19.457500 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m16:58:19.459503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027047631790>]}
[0m16:58:19.459503 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 0.95s]
[0m16:58:19.461503 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m16:58:19.461503 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:58:19.462502 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m16:58:19.463502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m16:58:19.464501 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m16:58:19.467500 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:58:19.468501 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 16:58:19.464501 => 16:58:19.468501
[0m16:58:19.469502 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m16:58:19.474501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:58:19.475501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:58:19.476505 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m16:58:19.476505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:20.058764 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:58:20.059765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m16:58:20.059765 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderDetailID",
        "SalesOrderID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail;
  );
[0m16:58:20.119955 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: select * from sales_order_detail;
                                         ^

[0m16:58:20.120969 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: ROLLBACK
[0m16:58:20.179974 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 16:58:19.469502 => 16:58:20.179974
[0m16:58:20.180975 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m16:58:20.185445 [debug] [Thread-1 (]: Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:58:20.185445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99889c1-1dd3-4980-b2cb-e43d2f945dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002704758AA50>]}
[0m16:58:20.186450 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model public.stg_sales_order_detail ............. [[31mERROR[0m in 0.72s]
[0m16:58:20.187452 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m16:58:20.189662 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m16:58:20.190667 [info ] [Thread-1 (]: 3 of 5 SKIP relation public.trans_sales_orders ................................. [[33mSKIP[0m]
[0m16:58:20.191671 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m16:58:20.193670 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m16:58:20.194669 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m16:58:20.195670 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m16:58:20.196668 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m16:58:20.197669 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m16:58:20.202677 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m16:58:20.207303 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:20.208289 [debug] [MainThread]: On master: BEGIN
[0m16:58:20.208289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:20.762056 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:58:20.762056 [debug] [MainThread]: On master: COMMIT
[0m16:58:20.763060 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:20.763060 [debug] [MainThread]: On master: COMMIT
[0m16:58:20.822252 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:58:20.823261 [debug] [MainThread]: On master: Close
[0m16:58:20.824259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:20.825258 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m16:58:20.825761 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m16:58:20.825761 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_order_detail' was properly closed.
[0m16:58:20.826770 [info ] [MainThread]: 
[0m16:58:20.826770 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m16:58:20.828800 [debug] [MainThread]: Command end result
[0m16:58:20.840824 [info ] [MainThread]: 
[0m16:58:20.842362 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:20.843375 [info ] [MainThread]: 
[0m16:58:20.845169 [error] [MainThread]:   Database Error in model stg_sales_order_detail (models\staging\stg_sales_order_detail.sql)
  syntax error at or near ";"
  LINE 17: select * from sales_order_detail;
                                           ^
  compiled Code at target\run\dbt_etl_adw\models\staging\stg_sales_order_detail.sql
[0m16:58:20.846594 [info ] [MainThread]: 
[0m16:58:20.847101 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
[0m16:58:20.849597 [debug] [MainThread]: Command `dbt run` failed at 16:58:20.849597 after 5.34 seconds
[0m16:58:20.850602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270402A1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270402E2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270402E3010>]}
[0m16:58:20.850602 [debug] [MainThread]: Flushing usage events
[0m17:05:03.307760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E020FA9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E020FAB150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E020FA8790>]}


============================== 17:05:03.311874 | 11d2149c-51e9-49fa-ab20-b0d1d21065b4 ==============================
[0m17:05:03.311874 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:05:03.312880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:05:03.523826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02119AE50>]}
[0m17:05:03.613367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E020A0CB90>]}
[0m17:05:03.615400 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:05:03.624367 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:05:03.737797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:03.738798 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_detail.sql
[0m17:05:04.049535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0215DB610>]}
[0m17:05:04.064610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E021391810>]}
[0m17:05:04.064610 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:05:04.065613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E021268490>]}
[0m17:05:04.067888 [info ] [MainThread]: 
[0m17:05:04.069958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:04.070987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:05:04.099470 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:05:04.100460 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:05:04.118462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:04.702351 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:05:04.703354 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:05:04.706352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:05:04.711437 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:05:04.711437 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:05:04.712352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:05.390156 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:05:05.390156 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:05:05.391663 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:05:05.464779 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:05:05.467775 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:05:05.536602 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:05:05.541809 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:05.542849 [debug] [MainThread]: On master: BEGIN
[0m17:05:05.543894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:06.100167 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:05:06.101190 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:06.101190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:05:06.164175 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:05:06.165082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E021479F90>]}
[0m17:05:06.166081 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:06.224226 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:06.225110 [debug] [MainThread]: On master: BEGIN
[0m17:05:06.341836 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:05:06.343254 [debug] [MainThread]: On master: COMMIT
[0m17:05:06.344260 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:06.345263 [debug] [MainThread]: On master: COMMIT
[0m17:05:06.403390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:05:06.404390 [debug] [MainThread]: On master: Close
[0m17:05:06.406389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:06.407391 [info ] [MainThread]: 
[0m17:05:06.410633 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:05:06.411969 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:05:06.413976 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:05:06.414975 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:05:06.424113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:05:06.425115 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:05:06.415974 => 17:05:06.425115
[0m17:05:06.427620 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:05:06.473680 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:05:06.474678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:05:06.475659 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:05:06.476661 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:05:07.069028 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:05:07.069028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:05:07.070125 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m17:05:07.138240 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:05:07.150200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:05:07.151201 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:05:07.214572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:07.217572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:05:07.217572 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:05:07.280920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:07.299429 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:05:07.299429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:05:07.300437 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:05:07.362708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:05:07.369705 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:05:07.374705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:05:07.375701 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:05:07.437842 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:05:07.440767 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:05:06.427620 => 17:05:07.439771
[0m17:05:07.441692 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:05:07.442772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0216A6A10>]}
[0m17:05:07.443749 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 1.03s]
[0m17:05:07.444686 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:05:07.445778 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:05:07.446681 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:05:07.448096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:05:07.448096 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:05:07.450177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:05:07.451093 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:05:07.449094 => 17:05:07.451093
[0m17:05:07.451093 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:05:07.455195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:05:07.457191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:05:07.457191 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:05:07.458101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:07.982178 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:05:07.983177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:05:07.984256 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail
  );
[0m17:05:08.040829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:05:08.044875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:05:08.045877 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:05:08.106649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:08.117239 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:05:08.120748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:05:08.121756 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:05:08.176433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:05:08.178939 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:05:08.179939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:05:08.180990 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:05:08.234772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:05:08.235953 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:05:07.452189 => 17:05:08.235953
[0m17:05:08.237012 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:05:08.237589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E020FB5D50>]}
[0m17:05:08.238176 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.79s]
[0m17:05:08.239204 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:05:08.240319 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:05:08.241331 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:05:08.242327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:05:08.243329 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:05:08.247024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:05:08.248929 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:05:08.243329 => 17:05:08.247929
[0m17:05:08.248929 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:05:08.254554 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:05:08.258215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:05:08.258215 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:05:08.259292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:08.812003 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:05:08.812890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:05:08.813882 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice",
        sd."TotalPrice"
    from "adventureworks2022"."public"."stg_sales_header" sh
    join "adventureworks2022"."public"."stg_sales_order_detail" sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:05:08.872443 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from combined;
                               ^

[0m17:05:08.874436 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:05:08.934842 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:05:08.248929 => 17:05:08.933738
[0m17:05:08.935855 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:05:08.944935 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:05:08.945865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d2149c-51e9-49fa-ab20-b0d1d21065b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0217452D0>]}
[0m17:05:08.946901 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.70s]
[0m17:05:08.948436 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:05:08.950349 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:05:08.950349 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m17:05:08.952349 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:05:08.953350 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:05:08.954441 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m17:05:08.955350 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:05:08.957348 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:08.958457 [debug] [MainThread]: On master: BEGIN
[0m17:05:08.960765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:09.524122 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:05:09.525131 [debug] [MainThread]: On master: COMMIT
[0m17:05:09.525131 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:09.526121 [debug] [MainThread]: On master: COMMIT
[0m17:05:09.585418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:05:09.585418 [debug] [MainThread]: On master: Close
[0m17:05:09.586416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:09.587417 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:05:09.587417 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:05:09.588418 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:05:09.588418 [info ] [MainThread]: 
[0m17:05:09.589418 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m17:05:09.591417 [debug] [MainThread]: Command end result
[0m17:05:09.604032 [info ] [MainThread]: 
[0m17:05:09.605024 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:05:09.606023 [info ] [MainThread]: 
[0m17:05:09.607262 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:05:09.608269 [info ] [MainThread]: 
[0m17:05:09.608269 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m17:05:09.611847 [debug] [MainThread]: Command `dbt run` failed at 17:05:09.611847 after 6.36 seconds
[0m17:05:09.612852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0210000D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E01A1D1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0211240D0>]}
[0m17:05:09.613928 [debug] [MainThread]: Flushing usage events
[0m17:07:53.292872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28D99FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28D987D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28D98D50>]}


============================== 17:07:53.296888 | 4863be2a-3692-4210-bd55-980dcb843f48 ==============================
[0m17:07:53.296888 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:07:53.298072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:53.498212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28DD8F50>]}
[0m17:07:53.581445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28DD8F50>]}
[0m17:07:53.583089 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:07:53.591116 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:07:53.667745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:53.667745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:53.675742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28F7B9D0>]}
[0m17:07:53.689248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28FE1AD0>]}
[0m17:07:53.689248 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:07:53.690729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F2903A150>]}
[0m17:07:53.692817 [info ] [MainThread]: 
[0m17:07:53.693734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:53.696057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:07:53.706193 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:07:53.707189 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:07:53.707189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:54.404636 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:07:54.406644 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:07:54.409654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:07:54.416631 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:07:54.417633 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:07:54.418637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:55.000366 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:07:55.002464 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:07:55.003441 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:07:55.068938 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:07:55.072938 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:07:55.134712 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:07:55.149814 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:55.149814 [debug] [MainThread]: On master: BEGIN
[0m17:07:55.150825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:55.844226 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:07:55.845456 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:55.846464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:07:55.922197 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:07:55.926257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28EE4490>]}
[0m17:07:55.927275 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:55.999064 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:55.999977 [debug] [MainThread]: On master: BEGIN
[0m17:07:56.162985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:07:56.164047 [debug] [MainThread]: On master: COMMIT
[0m17:07:56.165047 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:56.165047 [debug] [MainThread]: On master: COMMIT
[0m17:07:56.237291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:07:56.237291 [debug] [MainThread]: On master: Close
[0m17:07:56.238272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:56.239274 [info ] [MainThread]: 
[0m17:07:56.244272 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:07:56.245344 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:07:56.247269 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:07:56.247269 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:07:56.253278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:07:56.256387 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:07:56.248267 => 17:07:56.256387
[0m17:07:56.257270 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:07:56.297946 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:07:56.298947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:07:56.298947 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:07:56.299948 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:56.812248 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:07:56.813289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:07:56.814294 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m17:07:56.869032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:07:56.877946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:07:56.878958 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:07:56.931615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:56.935703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:07:56.935703 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:07:56.987949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:57.003375 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:07:57.004376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:07:57.004376 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:07:57.057382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:07:57.068381 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:07:57.075382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:07:57.075382 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:07:57.128990 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:07:57.131658 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:07:56.258272 => 17:07:57.131658
[0m17:07:57.132678 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:07:57.133691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F2908FFD0>]}
[0m17:07:57.134702 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 0.89s]
[0m17:07:57.135698 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:07:57.136698 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:07:57.137699 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:07:57.138697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:07:57.139700 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:07:57.141705 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.143699 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:07:57.139700 => 17:07:57.142702
[0m17:07:57.143699 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:07:57.149699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.150700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.151700 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:07:57.151700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:57.687888 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:07:57.687888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.688886 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail
  );
[0m17:07:57.743765 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:07:57.750925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.751846 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m17:07:57.805237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:57.813316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.815247 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:07:57.868645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:07:57.873643 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:07:57.874648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.875642 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:07:57.929785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:07:57.936785 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:07:57.937784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:07:57.938779 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:07:57.992709 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:07:57.996211 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:07:57.144700 => 17:07:57.996211
[0m17:07:57.997208 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:07:57.998209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F290CAC90>]}
[0m17:07:57.999205 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.86s]
[0m17:07:58.000711 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:07:58.001897 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:07:58.001897 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:07:58.003920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:07:58.004909 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:07:58.008415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:07:58.009919 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:07:58.004909 => 17:07:58.009919
[0m17:07:58.009919 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:07:58.016935 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:07:58.017941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:07:58.018940 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:07:58.018940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:58.504819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:07:58.505813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:07:58.505813 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice",
        sd."TotalPrice"
    from "adventureworks2022"."public"."stg_sales_header" sh
    join "adventureworks2022"."public"."stg_sales_order_detail" sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:07:58.556979 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from combined;
                               ^

[0m17:07:58.558105 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:07:58.614202 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:07:58.011424 => 17:07:58.614202
[0m17:07:58.615208 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:07:58.622901 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:07:58.623829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4863be2a-3692-4210-bd55-980dcb843f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F292D2CD0>]}
[0m17:07:58.624419 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.62s]
[0m17:07:58.625420 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:07:58.627489 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:07:58.628997 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m17:07:58.631340 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:07:58.631340 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:07:58.632339 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m17:07:58.633351 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:07:58.635853 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:58.636854 [debug] [MainThread]: On master: BEGIN
[0m17:07:58.637859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:59.193139 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:07:59.194162 [debug] [MainThread]: On master: COMMIT
[0m17:07:59.194162 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:59.195162 [debug] [MainThread]: On master: COMMIT
[0m17:07:59.254876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:07:59.256875 [debug] [MainThread]: On master: Close
[0m17:07:59.262874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:59.262874 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:07:59.264882 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:07:59.265876 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:07:59.266876 [info ] [MainThread]: 
[0m17:07:59.268104 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m17:07:59.270309 [debug] [MainThread]: Command end result
[0m17:07:59.282779 [info ] [MainThread]: 
[0m17:07:59.282779 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:59.284256 [info ] [MainThread]: 
[0m17:07:59.285265 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:07:59.286634 [info ] [MainThread]: 
[0m17:07:59.288657 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m17:07:59.292807 [debug] [MainThread]: Command `dbt run` failed at 17:07:59.292807 after 6.07 seconds
[0m17:07:59.293809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F21FB1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F28AC6FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F21FF2450>]}
[0m17:07:59.293809 [debug] [MainThread]: Flushing usage events
[0m17:08:35.690704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D69AA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D698C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D69A310>]}


============================== 17:08:35.695703 | 6640dde3-21fd-4896-84a6-61acdabb1591 ==============================
[0m17:08:35.695703 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:08:35.696704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:08:35.901320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D7CC3D0>]}
[0m17:08:35.995990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D7DBE90>]}
[0m17:08:35.997992 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:08:36.006992 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:08:36.078381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:36.078381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:36.085378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D854F50>]}
[0m17:08:36.101209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D8CC250>]}
[0m17:08:36.101209 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:08:36.102209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D707B90>]}
[0m17:08:36.105209 [info ] [MainThread]: 
[0m17:08:36.106233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:36.108234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:08:36.117233 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:08:36.117233 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:08:36.118235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:36.816491 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:08:36.817490 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:08:36.821549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:08:36.827579 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:08:36.828485 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:08:36.828485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:37.418486 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:08:37.419598 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:08:37.419598 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:08:37.482733 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:08:37.483718 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:08:37.543908 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:08:37.552387 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:37.552387 [debug] [MainThread]: On master: BEGIN
[0m17:08:37.553819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:38.058827 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:08:38.059817 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:38.060906 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:08:38.117576 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:08:38.122592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D6A7B90>]}
[0m17:08:38.123592 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:38.175397 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:38.177348 [debug] [MainThread]: On master: BEGIN
[0m17:08:38.279945 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:08:38.281964 [debug] [MainThread]: On master: COMMIT
[0m17:08:38.283966 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:38.283966 [debug] [MainThread]: On master: COMMIT
[0m17:08:38.335286 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:08:38.336253 [debug] [MainThread]: On master: Close
[0m17:08:38.337245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:38.338246 [info ] [MainThread]: 
[0m17:08:38.343240 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:08:38.343240 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:08:38.345246 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:08:38.345246 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:08:38.354594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:08:38.357026 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:08:38.346239 => 17:08:38.355552
[0m17:08:38.358035 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:08:38.402673 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:08:38.403675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:08:38.404676 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:08:38.405670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:38.978851 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:08:38.980950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:08:38.981965 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m17:08:39.045641 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:08:39.059121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:08:39.060119 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:08:39.121906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:39.126534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:08:39.127588 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:08:39.189137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:39.204161 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:08:39.205171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:08:39.205171 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:08:39.268132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:08:39.273647 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:08:39.277652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:08:39.277652 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:08:39.341512 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:08:39.347060 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:08:38.358035 => 17:08:39.347060
[0m17:08:39.349058 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:08:39.351058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D938210>]}
[0m17:08:39.352051 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 1.01s]
[0m17:08:39.353058 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:08:39.354061 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:08:39.354061 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:08:39.356059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:08:39.356059 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:08:39.358452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:39.359487 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:08:39.357058 => 17:08:39.359487
[0m17:08:39.360818 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:08:39.367834 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:39.371835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:39.372837 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:08:39.372837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:39.858125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:08:39.858125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:39.859124 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail
  );
[0m17:08:39.913478 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:08:39.916484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:39.916484 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m17:08:39.969246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:39.975228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:39.976225 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:08:40.029544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:08:40.031429 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:08:40.032519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:40.032519 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:08:40.085417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:08:40.088534 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:08:40.089533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:08:40.090534 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:08:40.143402 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:08:40.146419 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:08:39.360818 => 17:08:40.146419
[0m17:08:40.147935 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:08:40.148950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5DB85110>]}
[0m17:08:40.149949 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.79s]
[0m17:08:40.150949 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:08:40.152048 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:08:40.153592 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:08:40.154601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:08:40.154601 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:08:40.160423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:08:40.162412 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:08:40.155606 => 17:08:40.161416
[0m17:08:40.163413 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:08:40.172478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:08:40.175103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:08:40.177574 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:08:40.177574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:40.762843 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:08:40.763785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:08:40.763785 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice",
        sd."TotalPrice"
    from "adventureworks2022"."public"."stg_sales_header" sh
    join "adventureworks2022"."public"."stg_sales_order_detail" sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:08:40.826056 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from combined;
                               ^

[0m17:08:40.827053 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:08:40.889832 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:08:40.163413 => 17:08:40.888689
[0m17:08:40.891753 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:08:40.899897 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:08:40.900906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6640dde3-21fd-4896-84a6-61acdabb1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5DA94310>]}
[0m17:08:40.900906 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.75s]
[0m17:08:40.902904 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:08:40.903904 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:08:40.903904 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m17:08:40.905409 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:08:40.906414 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:08:40.907416 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m17:08:40.908420 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:08:40.910556 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:40.911924 [debug] [MainThread]: On master: BEGIN
[0m17:08:40.911924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:41.468945 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:08:41.470028 [debug] [MainThread]: On master: COMMIT
[0m17:08:41.470028 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:41.470028 [debug] [MainThread]: On master: COMMIT
[0m17:08:41.529605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:08:41.530610 [debug] [MainThread]: On master: Close
[0m17:08:41.531615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:41.531615 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:08:41.532613 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:08:41.532613 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:08:41.533611 [info ] [MainThread]: 
[0m17:08:41.536290 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m17:08:41.538315 [debug] [MainThread]: Command end result
[0m17:08:41.547296 [info ] [MainThread]: 
[0m17:08:41.548296 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:08:41.549299 [info ] [MainThread]: 
[0m17:08:41.550299 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:08:41.551753 [info ] [MainThread]: 
[0m17:08:41.552762 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m17:08:41.554765 [debug] [MainThread]: Command `dbt run` failed at 17:08:41.553767 after 5.93 seconds
[0m17:08:41.555765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A56921790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D194610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A5D10CD90>]}
[0m17:08:41.557770 [debug] [MainThread]: Flushing usage events
[0m17:09:12.979115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC57A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC586210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFB1DC690>]}


============================== 17:09:12.983821 | 16c47890-b31e-45c1-9436-6fec31306810 ==============================
[0m17:09:12.983821 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:09:12.985790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:13.188565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC579010>]}
[0m17:09:13.280311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC579010>]}
[0m17:09:13.282299 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:09:13.292305 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:09:13.357338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:13.357338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:13.364720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC840290>]}
[0m17:09:13.386089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC6DD690>]}
[0m17:09:13.388090 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:09:13.389266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC875990>]}
[0m17:09:13.393276 [info ] [MainThread]: 
[0m17:09:13.396756 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:13.401921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:09:13.418257 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:09:13.419257 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:09:13.419257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:13.985900 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:09:13.988003 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:09:13.989989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:09:13.995008 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:09:13.996017 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:09:13.996017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:14.557218 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:09:14.558213 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:09:14.560215 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:09:14.622723 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:09:14.625134 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:09:14.686006 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:09:14.694360 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:14.695359 [debug] [MainThread]: On master: BEGIN
[0m17:09:14.696360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:15.184002 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:15.184002 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:15.184999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:15.241980 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:09:15.243978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC80BA90>]}
[0m17:09:15.244977 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:15.296036 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:15.297035 [debug] [MainThread]: On master: BEGIN
[0m17:09:15.399535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:09:15.400634 [debug] [MainThread]: On master: COMMIT
[0m17:09:15.403639 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:15.403639 [debug] [MainThread]: On master: COMMIT
[0m17:09:15.455700 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:15.456713 [debug] [MainThread]: On master: Close
[0m17:09:15.459239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:15.460239 [info ] [MainThread]: 
[0m17:09:15.464341 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:09:15.465341 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:09:15.467423 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:09:15.468428 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:09:15.479054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:09:15.480722 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:09:15.468428 => 17:09:15.480722
[0m17:09:15.481751 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:09:15.530247 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:09:15.531243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:09:15.532316 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:09:15.532316 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:16.108869 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:09:16.110332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:09:16.110332 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m17:09:16.170696 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:16.178694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:09:16.179694 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:09:16.239948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:16.243225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:09:16.244141 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:09:16.302854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:16.322008 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:09:16.322008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:09:16.323007 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:09:16.382859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:16.387864 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:09:16.392866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:09:16.392866 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:09:16.453689 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:16.456689 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:09:15.481751 => 17:09:16.456689
[0m17:09:16.456689 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:09:16.457907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC8C4390>]}
[0m17:09:16.459271 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 0.99s]
[0m17:09:16.460754 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:09:16.460754 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:09:16.461767 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:09:16.462992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:09:16.462992 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:09:16.465503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:16.466508 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:09:16.462992 => 17:09:16.466508
[0m17:09:16.466508 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:09:16.470531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:16.472979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:16.473977 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:09:16.474980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:17.027913 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:09:17.028914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:17.028914 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail
  );
[0m17:09:17.089024 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:09:17.094546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:17.094546 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m17:09:17.154058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:17.158058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:17.159564 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:09:17.218162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:09:17.221067 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:09:17.221067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:17.221067 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:09:17.281405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:09:17.284919 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:09:17.285920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:09:17.286920 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:09:17.347000 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:09:17.350644 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:09:16.467527 => 17:09:17.350644
[0m17:09:17.352648 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:09:17.353730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFC817590>]}
[0m17:09:17.355640 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.89s]
[0m17:09:17.356638 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:09:17.357636 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:09:17.359144 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:09:17.360150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:09:17.361214 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:09:17.366151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:09:17.368151 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:09:17.362151 => 17:09:17.368151
[0m17:09:17.369225 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:09:17.378557 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:09:17.379560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:09:17.380558 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:09:17.381557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:17.889571 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:09:17.891642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:09:17.893563 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice",
        sd."TotalPrice"
    from "adventureworks2022"."public"."stg_sales_header" sh
    join "adventureworks2022"."public"."stg_sales_order_detail" sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:09:17.947778 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from combined;
                               ^

[0m17:09:17.949881 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:09:18.004971 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:09:17.370150 => 17:09:18.003851
[0m17:09:18.006869 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:09:18.015947 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:09:18.016859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16c47890-b31e-45c1-9436-6fec31306810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFCACB610>]}
[0m17:09:18.016859 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.66s]
[0m17:09:18.017977 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:09:18.019963 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:09:18.020972 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m17:09:18.022027 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:09:18.023009 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:09:18.023009 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m17:09:18.023971 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:09:18.025974 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:18.026974 [debug] [MainThread]: On master: BEGIN
[0m17:09:18.027973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:18.538764 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:09:18.539885 [debug] [MainThread]: On master: COMMIT
[0m17:09:18.540804 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:18.541851 [debug] [MainThread]: On master: COMMIT
[0m17:09:18.594642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:09:18.594642 [debug] [MainThread]: On master: Close
[0m17:09:18.596632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:18.596632 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:09:18.597631 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:09:18.597631 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:09:18.598633 [info ] [MainThread]: 
[0m17:09:18.599634 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m17:09:18.601637 [debug] [MainThread]: Command end result
[0m17:09:18.613056 [info ] [MainThread]: 
[0m17:09:18.614054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:09:18.615395 [info ] [MainThread]: 
[0m17:09:18.616402 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:09:18.617408 [info ] [MainThread]: 
[0m17:09:18.618403 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m17:09:18.619787 [debug] [MainThread]: Command `dbt run` failed at 17:09:18.619787 after 5.70 seconds
[0m17:09:18.621982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEF5791790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEF57D2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEFBFDCB90>]}
[0m17:09:18.622987 [debug] [MainThread]: Flushing usage events
[0m17:09:59.309461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9DB9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9DB8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9DB8C50>]}


============================== 17:09:59.315462 | 76f4a41e-6cae-4234-b937-7ccbd30fb81e ==============================
[0m17:09:59.315462 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:09:59.316480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models trans_sales_orders', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:09:59.523191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76f4a41e-6cae-4234-b937-7ccbd30fb81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9F07E50>]}
[0m17:09:59.614226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76f4a41e-6cae-4234-b937-7ccbd30fb81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9FBBD10>]}
[0m17:09:59.616224 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:09:59.629298 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:09:59.698351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:59.698351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:59.707349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f4a41e-6cae-4234-b937-7ccbd30fb81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3AA1A23D0>]}
[0m17:09:59.726353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76f4a41e-6cae-4234-b937-7ccbd30fb81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3AA030310>]}
[0m17:09:59.727350 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:09:59.728351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f4a41e-6cae-4234-b937-7ccbd30fb81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9A21B90>]}
[0m17:09:59.730350 [info ] [MainThread]: 
[0m17:09:59.732354 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:59.734352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:09:59.748350 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:09:59.749352 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:09:59.749352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:00.277836 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:10:00.280842 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:10:00.285842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:10:00.291842 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:10:00.291842 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:10:00.292842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:00.833618 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:10:00.835615 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:10:00.836611 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:10:00.892801 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:10:00.895799 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:10:00.948841 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:10:00.955074 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:00.956079 [debug] [MainThread]: On master: BEGIN
[0m17:10:00.956079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:01.543514 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:10:01.545479 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:01.546488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:01.613917 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:10:01.617918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f4a41e-6cae-4234-b937-7ccbd30fb81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9F35890>]}
[0m17:10:01.618423 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:01.680029 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:01.681031 [debug] [MainThread]: On master: BEGIN
[0m17:10:01.805301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:10:01.806302 [debug] [MainThread]: On master: COMMIT
[0m17:10:01.807300 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:01.807300 [debug] [MainThread]: On master: COMMIT
[0m17:10:01.869710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:10:01.870713 [debug] [MainThread]: On master: Close
[0m17:10:01.871712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:01.872719 [info ] [MainThread]: 
[0m17:10:01.877731 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:10:01.878728 [info ] [Thread-1 (]: 1 of 1 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:10:01.880734 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.trans_sales_orders'
[0m17:10:01.880734 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:10:01.891748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:01.892766 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:10:01.881733 => 17:10:01.892766
[0m17:10:01.893747 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:10:01.934834 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:01.936915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:01.937832 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:10:01.938833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:02.535317 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:10:02.536397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:02.537318 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice",
        sd."TotalPrice"
    from "adventureworks2022"."public"."stg_sales_header" sh
    join "adventureworks2022"."public"."stg_sales_order_detail" sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:10:02.599833 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from combined;
                               ^

[0m17:10:02.601233 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:10:02.663636 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:10:01.893747 => 17:10:02.662526
[0m17:10:02.664639 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:10:02.669642 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:10:02.670633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f4a41e-6cae-4234-b937-7ccbd30fb81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3AA193CD0>]}
[0m17:10:02.671633 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.79s]
[0m17:10:02.672634 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:10:02.675638 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:02.676637 [debug] [MainThread]: On master: BEGIN
[0m17:10:02.676637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:03.235158 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:10:03.237256 [debug] [MainThread]: On master: COMMIT
[0m17:10:03.238283 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:03.239894 [debug] [MainThread]: On master: COMMIT
[0m17:10:03.299046 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:10:03.300065 [debug] [MainThread]: On master: Close
[0m17:10:03.303695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:03.304780 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:10:03.305686 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:10:03.305686 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:10:03.307525 [info ] [MainThread]: 
[0m17:10:03.308216 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m17:10:03.310214 [debug] [MainThread]: Command end result
[0m17:10:03.318516 [info ] [MainThread]: 
[0m17:10:03.319524 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:03.320527 [info ] [MainThread]: 
[0m17:10:03.322528 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:10:03.322528 [info ] [MainThread]: 
[0m17:10:03.324139 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:10:03.327419 [debug] [MainThread]: Command `dbt run` failed at 17:10:03.326326 after 4.08 seconds
[0m17:10:03.328407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A30117D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A32FB610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3A9FF6450>]}
[0m17:10:03.328407 [debug] [MainThread]: Flushing usage events
[0m17:10:52.255363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB3C8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB3CB2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB3CA910>]}


============================== 17:10:52.259372 | 13b44ad8-3dae-42de-a898-c1f8b8b6307a ==============================
[0m17:10:52.259372 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:10:52.261373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models trans_sales_orders', 'send_anonymous_usage_stats': 'True'}
[0m17:10:52.449832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13b44ad8-3dae-42de-a898-c1f8b8b6307a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB5B48D0>]}
[0m17:10:52.539809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13b44ad8-3dae-42de-a898-c1f8b8b6307a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB514710>]}
[0m17:10:52.541318 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:10:52.551373 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:10:52.628988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:52.628988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:52.634995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13b44ad8-3dae-42de-a898-c1f8b8b6307a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB79B7D0>]}
[0m17:10:52.647754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13b44ad8-3dae-42de-a898-c1f8b8b6307a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB418490>]}
[0m17:10:52.647754 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:10:52.648754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13b44ad8-3dae-42de-a898-c1f8b8b6307a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB81FED0>]}
[0m17:10:52.650753 [info ] [MainThread]: 
[0m17:10:52.651752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:52.653753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:10:52.663753 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:10:52.663753 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:10:52.664753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:53.248163 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:10:53.251261 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:10:53.257188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:10:53.265179 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:10:53.266179 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:10:53.266179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:53.896163 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:10:53.898244 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:10:53.900169 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:10:53.969711 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:10:53.973706 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:10:54.040219 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:10:54.046219 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:54.047220 [debug] [MainThread]: On master: BEGIN
[0m17:10:54.047220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:54.634227 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:10:54.634227 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:54.635277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:54.699242 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:10:54.702320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13b44ad8-3dae-42de-a898-c1f8b8b6307a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB572190>]}
[0m17:10:54.703331 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:54.764022 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:54.765011 [debug] [MainThread]: On master: BEGIN
[0m17:10:54.884496 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:10:54.885490 [debug] [MainThread]: On master: COMMIT
[0m17:10:54.885490 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:54.885490 [debug] [MainThread]: On master: COMMIT
[0m17:10:54.946415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:10:54.947418 [debug] [MainThread]: On master: Close
[0m17:10:54.948416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:54.949417 [info ] [MainThread]: 
[0m17:10:54.952924 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:10:54.954932 [info ] [Thread-1 (]: 1 of 1 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:10:54.955933 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.trans_sales_orders'
[0m17:10:54.956930 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:10:54.967931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:54.980933 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:10:54.956930 => 17:10:54.979930
[0m17:10:54.980933 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:10:55.044842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:55.046841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:55.047871 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:10:55.048841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:55.559835 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:10:55.559835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:10:55.560835 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice",
        sd."TotalPrice"
    from "adventureworks2022"."public"."stg_sales_header" sh
    join "adventureworks2022"."public"."stg_sales_order_detail" sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:10:55.613102 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from combined;
                               ^

[0m17:10:55.614116 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:10:55.667918 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:10:54.981934 => 17:10:55.666923
[0m17:10:55.668935 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:10:55.673931 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:10:55.674930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13b44ad8-3dae-42de-a898-c1f8b8b6307a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB8610D0>]}
[0m17:10:55.674930 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.72s]
[0m17:10:55.676931 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:10:55.681730 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:55.682732 [debug] [MainThread]: On master: BEGIN
[0m17:10:55.682732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:56.185403 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:10:56.185403 [debug] [MainThread]: On master: COMMIT
[0m17:10:56.186486 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:56.186486 [debug] [MainThread]: On master: COMMIT
[0m17:10:56.239541 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:10:56.240552 [debug] [MainThread]: On master: Close
[0m17:10:56.241551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:56.241551 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:10:56.241551 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:10:56.242557 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:10:56.242557 [info ] [MainThread]: 
[0m17:10:56.243558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m17:10:56.245560 [debug] [MainThread]: Command end result
[0m17:10:56.254597 [info ] [MainThread]: 
[0m17:10:56.255558 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:56.256539 [info ] [MainThread]: 
[0m17:10:56.257547 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:10:56.258650 [info ] [MainThread]: 
[0m17:10:56.259555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:10:56.261553 [debug] [MainThread]: Command `dbt run` failed at 17:10:56.261553 after 4.07 seconds
[0m17:10:56.262554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB437650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBD46517D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBDB52E410>]}
[0m17:10:56.264565 [debug] [MainThread]: Flushing usage events
[0m17:11:59.687843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4737790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4737150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F338C390>]}


============================== 17:11:59.692851 | dab34c56-fb38-4bf7-ae9c-9d50a2cda93c ==============================
[0m17:11:59.692851 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:11:59.693854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models trans_sales_orders', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:11:59.901734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab34c56-fb38-4bf7-ae9c-9d50a2cda93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4797750>]}
[0m17:11:59.992118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab34c56-fb38-4bf7-ae9c-9d50a2cda93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4121C50>]}
[0m17:11:59.994034 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:12:00.003660 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:12:00.068058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:00.069057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:00.074151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab34c56-fb38-4bf7-ae9c-9d50a2cda93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4AFB7D0>]}
[0m17:12:00.087067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab34c56-fb38-4bf7-ae9c-9d50a2cda93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F49C7190>]}
[0m17:12:00.088068 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:12:00.089065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab34c56-fb38-4bf7-ae9c-9d50a2cda93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F49E9750>]}
[0m17:12:00.091161 [info ] [MainThread]: 
[0m17:12:00.092933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:00.095018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:12:00.105683 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:12:00.105683 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:12:00.106777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:00.705553 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:12:00.707454 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:12:00.709593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:12:00.714670 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:12:00.715676 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:12:00.715676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:01.303236 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:12:01.305230 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:12:01.306741 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:12:01.370035 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:12:01.373682 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:12:01.434342 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:12:01.441002 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:01.442003 [debug] [MainThread]: On master: BEGIN
[0m17:12:01.442003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:01.989587 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:12:01.990477 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:01.990477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:02.053543 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:12:02.056549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab34c56-fb38-4bf7-ae9c-9d50a2cda93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F49158D0>]}
[0m17:12:02.057549 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:02.117850 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:02.118799 [debug] [MainThread]: On master: BEGIN
[0m17:12:02.236168 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:12:02.238266 [debug] [MainThread]: On master: COMMIT
[0m17:12:02.239267 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:02.240189 [debug] [MainThread]: On master: COMMIT
[0m17:12:02.300084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:12:02.300084 [debug] [MainThread]: On master: Close
[0m17:12:02.302144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:02.303124 [info ] [MainThread]: 
[0m17:12:02.306771 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:12:02.307770 [info ] [Thread-1 (]: 1 of 1 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:12:02.309771 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.trans_sales_orders'
[0m17:12:02.309771 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:12:02.320282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:12:02.322282 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:12:02.311276 => 17:12:02.321287
[0m17:12:02.322282 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:12:02.362362 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:12:02.363292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:12:02.366285 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:12:02.368284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:02.935611 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:12:02.937726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:12:02.938718 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice",
        sd."TotalPrice"
    from "adventureworks2022"."public"."stg_sales_header" sh
    join "adventureworks2022"."public"."stg_sales_order_detail" sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:12:03.000468 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from combined;
                               ^

[0m17:12:03.002369 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:12:03.063497 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:12:02.323374 => 17:12:03.062422
[0m17:12:03.063497 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:12:03.070504 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:12:03.071503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab34c56-fb38-4bf7-ae9c-9d50a2cda93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F4ADEB50>]}
[0m17:12:03.071503 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.76s]
[0m17:12:03.073439 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:12:03.075464 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:03.076499 [debug] [MainThread]: On master: BEGIN
[0m17:12:03.076499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:03.662601 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:12:03.663686 [debug] [MainThread]: On master: COMMIT
[0m17:12:03.664695 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:03.665609 [debug] [MainThread]: On master: COMMIT
[0m17:12:03.727107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:12:03.727107 [debug] [MainThread]: On master: Close
[0m17:12:03.728107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:03.729466 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:12:03.730483 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:12:03.730483 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:12:03.731479 [info ] [MainThread]: 
[0m17:12:03.732474 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m17:12:03.733478 [debug] [MainThread]: Command end result
[0m17:12:03.743994 [info ] [MainThread]: 
[0m17:12:03.745244 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:12:03.746252 [info ] [MainThread]: 
[0m17:12:03.746252 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:12:03.747729 [info ] [MainThread]: 
[0m17:12:03.748737 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:12:03.750736 [debug] [MainThread]: Command `dbt run` failed at 17:12:03.750736 after 4.13 seconds
[0m17:12:03.751736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202ED9217D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202EDC14410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202F418CED0>]}
[0m17:12:03.751736 [debug] [MainThread]: Flushing usage events
[0m17:16:56.432991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0789E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C078AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C078B5D0>]}


============================== 17:16:56.437991 | 3e80cc34-ed7c-45ea-b489-dbf165b3674b ==============================
[0m17:16:56.437991 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:16:56.438991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:56.660643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0917A90>]}
[0m17:16:56.778826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C08CBD90>]}
[0m17:16:56.779803 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:16:56.797212 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:16:56.877669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:56.877669 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m17:16:57.141944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0C97ED0>]}
[0m17:16:57.163586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0B71790>]}
[0m17:16:57.163586 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:16:57.164586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0A49F50>]}
[0m17:16:57.166590 [info ] [MainThread]: 
[0m17:16:57.168684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:57.170586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:16:57.180683 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:16:57.181614 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:16:57.182589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:57.778187 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:16:57.781202 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:16:57.785199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:16:57.793283 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:16:57.793283 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:16:57.794245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:58.416668 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:16:58.418764 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:16:58.419686 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:16:58.490731 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:16:58.493730 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:16:58.559938 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:16:58.566844 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:58.566844 [debug] [MainThread]: On master: BEGIN
[0m17:16:58.566844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:59.092061 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:16:59.093979 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:59.094977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:59.152861 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:16:59.154879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0E1B790>]}
[0m17:16:59.154879 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:59.206913 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:59.207866 [debug] [MainThread]: On master: BEGIN
[0m17:16:59.312907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:59.313903 [debug] [MainThread]: On master: COMMIT
[0m17:16:59.314895 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:59.314895 [debug] [MainThread]: On master: COMMIT
[0m17:16:59.375494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:59.375494 [debug] [MainThread]: On master: Close
[0m17:16:59.377493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:59.378493 [info ] [MainThread]: 
[0m17:16:59.382492 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:16:59.383494 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:16:59.384492 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:16:59.385496 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:16:59.392592 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:16:59.393535 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:16:59.385496 => 17:16:59.393535
[0m17:16:59.394587 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:16:59.434174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:16:59.435103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:16:59.435103 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:16:59.436170 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:16:59.925501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:16:59.926503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:16:59.926503 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m17:16:59.982360 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:16:59.989884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:16:59.989884 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:17:00.044513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:00.046612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:00.047619 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:17:00.101350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:00.119731 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:17:00.120735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:00.120735 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:17:00.174567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:17:00.188568 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:17:00.195570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:00.196566 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:17:00.251891 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:17:00.253890 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:16:59.394587 => 17:17:00.253890
[0m17:17:00.254889 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:17:00.256890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0EBE4D0>]}
[0m17:17:00.256890 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 0.87s]
[0m17:17:00.258894 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:17:00.258894 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:00.259894 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:17:00.260895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:17:00.261905 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:00.263896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:00.265897 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:17:00.261905 => 17:17:00.264896
[0m17:17:00.265897 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:00.271897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:00.273416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:00.273416 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:17:00.274414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:00.858105 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:17:00.859111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:00.859111 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail
  );
[0m17:17:00.923376 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:17:00.927380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:00.927380 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m17:17:00.989550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:00.992710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:00.993717 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:17:01.055742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:01.059663 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:17:01.060664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:01.061670 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:17:01.124619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:17:01.131727 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:17:01.132631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:01.133706 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:17:01.197165 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:17:01.199169 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:17:00.265897 => 17:17:01.199169
[0m17:17:01.199169 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:17:01.200170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0C2E950>]}
[0m17:17:01.201577 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.94s]
[0m17:17:01.203041 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:01.203041 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:17:01.204053 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:17:01.205507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:17:01.205507 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:17:01.207920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:01.208919 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:17:01.205507 => 17:17:01.208919
[0m17:17:01.209921 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:17:01.215282 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:01.217282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:01.218283 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:17:01.218283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:01.775976 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:17:01.776977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:01.776977 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice"
    from public.salesorderheader as sh
    join public.salesorderdetail as sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:17:01.836795 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: select * from combined;
                               ^

[0m17:17:01.837797 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:17:01.897351 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:17:01.209921 => 17:17:01.896351
[0m17:17:01.898353 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:17:01.903717 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 20: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:17:01.904723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e80cc34-ed7c-45ea-b489-dbf165b3674b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C0F27FD0>]}
[0m17:17:01.905728 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.70s]
[0m17:17:01.906725 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:17:01.908726 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:17:01.908726 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m17:17:01.909722 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:17:01.910725 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:17:01.910725 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m17:17:01.911724 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:17:01.913951 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:01.914950 [debug] [MainThread]: On master: BEGIN
[0m17:17:01.914950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:02.406056 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:02.406056 [debug] [MainThread]: On master: COMMIT
[0m17:17:02.407063 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:02.407063 [debug] [MainThread]: On master: COMMIT
[0m17:17:02.459144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:02.459144 [debug] [MainThread]: On master: Close
[0m17:17:02.461152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:02.461152 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:17:02.462152 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:17:02.462152 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:17:02.463152 [info ] [MainThread]: 
[0m17:17:02.464152 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m17:17:02.465150 [debug] [MainThread]: Command end result
[0m17:17:02.474150 [info ] [MainThread]: 
[0m17:17:02.475151 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:02.476656 [info ] [MainThread]: 
[0m17:17:02.477661 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 20: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:17:02.478663 [info ] [MainThread]: 
[0m17:17:02.479663 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m17:17:02.480663 [debug] [MainThread]: Command `dbt run` failed at 17:17:02.480663 after 6.11 seconds
[0m17:17:02.481664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B9A01790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B9A42490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265C07948D0>]}
[0m17:17:02.483155 [debug] [MainThread]: Flushing usage events
[0m17:17:22.125787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394D78AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394D86510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394D87850>]}


============================== 17:17:22.129776 | 238ed708-5613-4de9-9932-5311071ede52 ==============================
[0m17:17:22.129776 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:17:22.131689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:17:22.318022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394DF8B10>]}
[0m17:17:22.417537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394E9CA90>]}
[0m17:17:22.419544 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:17:22.432619 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:17:22.510819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:22.511820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:22.517367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394DBB750>]}
[0m17:17:22.530980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539507FBD0>]}
[0m17:17:22.531981 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:17:22.532991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394FB6790>]}
[0m17:17:22.535380 [info ] [MainThread]: 
[0m17:17:22.537387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:22.539386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:17:22.547403 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:17:22.548404 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:17:22.548404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:23.146685 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:17:23.148759 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:17:23.151718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:17:23.156758 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:17:23.157785 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:17:23.157785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:23.669516 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:17:23.670591 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:17:23.670591 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:17:23.728264 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:17:23.731252 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:17:23.785336 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:17:23.792274 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:23.792274 [debug] [MainThread]: On master: BEGIN
[0m17:17:23.793274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:24.350451 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:17:24.351455 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:24.351455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:24.415194 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:17:24.417192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394F67D50>]}
[0m17:17:24.417192 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:24.476171 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:24.478172 [debug] [MainThread]: On master: BEGIN
[0m17:17:24.594819 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:24.595726 [debug] [MainThread]: On master: COMMIT
[0m17:17:24.595726 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:24.596644 [debug] [MainThread]: On master: COMMIT
[0m17:17:24.655318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:24.655318 [debug] [MainThread]: On master: Close
[0m17:17:24.656362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:24.657337 [info ] [MainThread]: 
[0m17:17:24.662411 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:17:24.663412 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:17:24.665493 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:17:24.666500 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:17:24.677743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:17:24.678775 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:17:24.666500 => 17:17:24.678775
[0m17:17:24.679744 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:17:24.729767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:17:24.730767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:24.730767 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:17:24.731765 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:25.298466 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:17:25.299475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:25.299475 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m17:17:25.360408 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:17:25.366407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:25.367406 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:17:25.426214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:25.430216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:25.433214 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:17:25.493647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:25.519695 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:17:25.520696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:25.521697 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:17:25.580692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:17:25.587693 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:17:25.592697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:17:25.593697 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:17:25.654207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:17:25.656675 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:17:24.680841 => 17:17:25.656675
[0m17:17:25.658786 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:17:25.660793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253950883D0>]}
[0m17:17:25.661793 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 1.00s]
[0m17:17:25.662794 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:17:25.663792 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:25.664793 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:17:25.665792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:17:25.666792 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:25.670890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:25.672699 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:17:25.666792 => 17:17:25.672193
[0m17:17:25.673709 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:25.680113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:25.682118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:25.682118 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:17:25.683239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:26.247702 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:17:26.248624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:26.249622 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail
  );
[0m17:17:26.311986 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:17:26.316983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:26.318985 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m17:17:26.380253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:26.389246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:26.390252 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:17:26.452016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:26.454026 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:17:26.455024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:26.455024 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:17:26.515653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:17:26.522745 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:17:26.524678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:17:26.525675 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:17:26.587716 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:17:26.589811 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:17:25.673709 => 17:17:26.588806
[0m17:17:26.589811 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:17:26.591796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025395152610>]}
[0m17:17:26.592788 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.93s]
[0m17:17:26.593795 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:17:26.594869 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:17:26.595795 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:17:26.596917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:17:26.597875 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:17:26.600799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:26.602796 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:17:26.597875 => 17:17:26.602796
[0m17:17:26.603827 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:17:26.611416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:26.612417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:26.613415 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:17:26.613415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:27.220266 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:17:27.221260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:17:27.222379 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select
        sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice"
    from public.salesorderheader as sh
    join public.salesorderdetail as sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined;
  );
[0m17:17:27.285793 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: select * from combined;
                               ^

[0m17:17:27.286785 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: ROLLBACK
[0m17:17:27.350078 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:17:26.603827 => 17:17:27.349099
[0m17:17:27.351078 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:17:27.359077 [debug] [Thread-1 (]: Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 20: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:17:27.360078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '238ed708-5613-4de9-9932-5311071ede52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253952C4550>]}
[0m17:17:27.361077 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model public.trans_sales_orders ................. [[31mERROR[0m in 0.76s]
[0m17:17:27.363075 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:17:27.365075 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:17:27.367213 [info ] [Thread-1 (]: 4 of 5 SKIP relation public.agg_sales_summary .................................. [[33mSKIP[0m]
[0m17:17:27.368423 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:17:27.369433 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:17:27.370432 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_sales ......................................... [[33mSKIP[0m]
[0m17:17:27.371443 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:17:27.375903 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:27.376905 [debug] [MainThread]: On master: BEGIN
[0m17:17:27.377904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:27.975817 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:17:27.977925 [debug] [MainThread]: On master: COMMIT
[0m17:17:27.978917 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:27.979848 [debug] [MainThread]: On master: COMMIT
[0m17:17:28.043491 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:28.043491 [debug] [MainThread]: On master: Close
[0m17:17:28.044491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:28.045500 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:17:28.045500 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:17:28.046415 [debug] [MainThread]: Connection 'model.dbt_etl_adw.trans_sales_orders' was properly closed.
[0m17:17:28.046415 [info ] [MainThread]: 
[0m17:17:28.047926 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m17:17:28.049936 [debug] [MainThread]: Command end result
[0m17:17:28.061044 [info ] [MainThread]: 
[0m17:17:28.062077 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:28.063037 [info ] [MainThread]: 
[0m17:17:28.064549 [error] [MainThread]:   Database Error in model trans_sales_orders (models\transform\trans_sales_orders.sql)
  syntax error at or near ";"
  LINE 20: select * from combined;
                                 ^
  compiled Code at target\run\dbt_etl_adw\models\transform\trans_sales_orders.sql
[0m17:17:28.064549 [info ] [MainThread]: 
[0m17:17:28.065566 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m17:17:28.067562 [debug] [MainThread]: Command `dbt run` failed at 17:17:28.067562 after 6.01 seconds
[0m17:17:28.069104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538DFF1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538E032490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025394D87850>]}
[0m17:17:28.069104 [debug] [MainThread]: Flushing usage events
[0m17:22:23.503779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54DDD8690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54DDE78D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54DDE7E50>]}


============================== 17:22:23.508051 | 5cf584b6-a686-4a01-8a25-26b9cd8a109b ==============================
[0m17:22:23.508051 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:22:23.510137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:22:23.511053 [info ] [MainThread]: dbt version: 1.7.11
[0m17:22:23.512053 [info ] [MainThread]: python version: 3.11.5
[0m17:22:23.513124 [info ] [MainThread]: python path: C:\Users\Shai\AppData\Local\Programs\Python\Python311\python.exe
[0m17:22:23.513124 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:22:23.605542 [info ] [MainThread]: Using profiles dir at C:\Users\Shai\.dbt
[0m17:22:23.606544 [info ] [MainThread]: Using profiles.yml file at C:\Users\Shai\.dbt\profiles.yml
[0m17:22:23.607544 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Shai\Documents\GitHub\aws-1st-DE-Project\dbt_project.yml
[0m17:22:23.609545 [info ] [MainThread]: adapter type: postgres
[0m17:22:23.610547 [info ] [MainThread]: adapter version: 1.7.11
[0m17:22:23.686590 [info ] [MainThread]: Configuration:
[0m17:22:23.687596 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:22:23.688597 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:22:23.689593 [info ] [MainThread]: Required dependencies:
[0m17:22:23.690591 [debug] [MainThread]: Executing "git --help"
[0m17:22:23.731556 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:22:23.732622 [debug] [MainThread]: STDERR: "b''"
[0m17:22:23.732622 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:22:23.733628 [info ] [MainThread]: Connection:
[0m17:22:23.734554 [info ] [MainThread]:   host: aws-adw.czmo6y6u8ehp.ap-southeast-1.rds.amazonaws.com
[0m17:22:23.736614 [info ] [MainThread]:   port: 5432
[0m17:22:23.736614 [info ] [MainThread]:   user: postgres
[0m17:22:23.737621 [info ] [MainThread]:   database: adventureworks2022
[0m17:22:23.739112 [info ] [MainThread]:   schema: public
[0m17:22:23.739112 [info ] [MainThread]:   connect_timeout: 10
[0m17:22:23.740359 [info ] [MainThread]:   role: None
[0m17:22:23.742368 [info ] [MainThread]:   search_path: None
[0m17:22:23.743364 [info ] [MainThread]:   keepalives_idle: 0
[0m17:22:23.743364 [info ] [MainThread]:   sslmode: None
[0m17:22:23.744365 [info ] [MainThread]:   sslcert: None
[0m17:22:23.745365 [info ] [MainThread]:   sslkey: None
[0m17:22:23.745365 [info ] [MainThread]:   sslrootcert: None
[0m17:22:23.746365 [info ] [MainThread]:   application_name: dbt
[0m17:22:23.747364 [info ] [MainThread]:   retries: 1
[0m17:22:23.747364 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:22:23.748385 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:22:23.749393 [debug] [MainThread]: Using postgres connection "debug"
[0m17:22:23.749393 [debug] [MainThread]: On debug: select 1 as id
[0m17:22:23.749393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:24.429724 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m17:22:24.430726 [debug] [MainThread]: On debug: Close
[0m17:22:24.431725 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:22:24.432724 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:22:24.433729 [debug] [MainThread]: Command `dbt debug` succeeded at 17:22:24.433729 after 1.00 seconds
[0m17:22:24.434732 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:22:24.434732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A547081790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54DE1C090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54D8D0850>]}
[0m17:22:24.434732 [debug] [MainThread]: Flushing usage events
[0m17:22:30.903825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABA78C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AB56C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABA79310>]}


============================== 17:22:30.907828 | 9115a923-a39a-4bbb-a740-9525a1e64f19 ==============================
[0m17:22:30.907828 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:22:30.908827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:22:31.173440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABAB9190>]}
[0m17:22:31.270449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABAFB210>]}
[0m17:22:31.271366 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:22:31.279951 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:22:31.370321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:31.371324 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m17:22:31.668307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABCBE8D0>]}
[0m17:22:31.691108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABE61D10>]}
[0m17:22:31.692114 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:22:31.693572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC070410>]}
[0m17:22:31.695578 [info ] [MainThread]: 
[0m17:22:31.696579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:22:31.699578 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:22:31.711578 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:22:31.712587 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:22:31.712587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:32.219965 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:22:32.221052 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:22:32.224003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:22:32.229051 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:22:32.229968 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:22:32.231169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:32.715645 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:22:32.715645 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:22:32.716644 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:22:32.776683 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:22:32.777685 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:22:32.829664 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:22:32.835664 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:32.836664 [debug] [MainThread]: On master: BEGIN
[0m17:22:32.837663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:33.516375 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:22:33.518211 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:33.519912 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:22:33.598009 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m17:22:33.599002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC094F90>]}
[0m17:22:33.600508 [debug] [MainThread]: On master: ROLLBACK
[0m17:22:33.671562 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:33.672561 [debug] [MainThread]: On master: BEGIN
[0m17:22:33.818731 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:22:33.819324 [debug] [MainThread]: On master: COMMIT
[0m17:22:33.820238 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:33.820238 [debug] [MainThread]: On master: COMMIT
[0m17:22:33.892879 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:22:33.893905 [debug] [MainThread]: On master: Close
[0m17:22:33.896411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:33.899451 [info ] [MainThread]: 
[0m17:22:33.908731 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:22:33.910733 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:22:33.914177 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:22:33.915178 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:22:33.925205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:22:33.926204 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:22:33.916176 => 17:22:33.926204
[0m17:22:33.927206 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:22:33.976561 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:22:33.978559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:22:33.979557 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:22:33.980556 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:34.559574 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:22:34.561681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:22:34.563593 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from public.salesorderheader
)
select * from sales_header
  );
[0m17:22:34.631537 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:34.643552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:22:34.644553 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:22:34.706670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:34.710666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:22:34.711668 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:22:34.772105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:34.788025 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:22:34.789025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:22:34.789025 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:22:34.850175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:34.859129 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:22:34.864128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:22:34.865129 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:22:34.926700 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:34.928699 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:22:33.928208 => 17:22:34.928699
[0m17:22:34.929700 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:22:34.930701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC1EC210>]}
[0m17:22:34.930701 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 1.02s]
[0m17:22:34.933185 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:22:34.933185 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:22:34.934184 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:22:34.935184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:22:34.935184 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:22:34.937669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:34.938712 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:22:34.935184 => 17:22:34.938712
[0m17:22:34.939716 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:22:34.946057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:34.948372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:34.948372 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:22:34.949774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:35.447449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:22:35.449551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:35.450552 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from public.salesorderdetail
)
select * from sales_order_detail
  );
[0m17:22:35.506617 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:35.514626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:35.515627 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m17:22:35.569869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:35.574965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:35.574965 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:22:35.629033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:35.633036 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:22:35.634030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:35.635035 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:22:35.689059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:35.692057 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:22:35.693056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:22:35.694057 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:22:35.748086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:35.751085 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:22:34.939716 => 17:22:35.750098
[0m17:22:35.751085 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:22:35.753084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABDB90D0>]}
[0m17:22:35.754088 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.82s]
[0m17:22:35.755126 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:22:35.755126 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:22:35.756135 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:22:35.758174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:22:35.758174 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:22:35.760227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:22:35.762132 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:22:35.759204 => 17:22:35.761220
[0m17:22:35.762132 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:22:35.768138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:22:35.769132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:22:35.770132 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:22:35.771131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:36.355885 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:22:36.355885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:22:36.356886 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice"
    from public.salesorderheader as sh
    join public.salesorderdetail as sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined
  );
[0m17:22:36.420814 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:22:36.424893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:22:36.425918 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */
alter table "adventureworks2022"."public"."trans_sales_orders__dbt_tmp" rename to "trans_sales_orders"
[0m17:22:36.488901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:22:36.491893 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: COMMIT
[0m17:22:36.492888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:22:36.492888 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: COMMIT
[0m17:22:36.562539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:22:36.566654 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."trans_sales_orders__dbt_backup"
[0m17:22:36.567650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:22:36.568655 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */
drop view if exists "adventureworks2022"."public"."trans_sales_orders__dbt_backup" cascade
[0m17:22:36.631060 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:22:36.633067 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:22:35.762132 => 17:22:36.633067
[0m17:22:36.633977 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:22:36.633977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC202590>]}
[0m17:22:36.635054 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.trans_sales_orders ..................... [[32mCREATE VIEW[0m in 0.88s]
[0m17:22:36.636981 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:22:36.637977 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:22:36.638977 [info ] [Thread-1 (]: 4 of 5 START sql view model public.agg_sales_summary ........................... [RUN]
[0m17:22:36.640461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.trans_sales_orders, now model.dbt_etl_adw.agg_sales_summary)
[0m17:22:36.640461 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.agg_sales_summary
[0m17:22:36.645083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:22:36.646084 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (compile): 17:22:36.641629 => 17:22:36.646084
[0m17:22:36.647584 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.agg_sales_summary
[0m17:22:36.652852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:22:36.655271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:22:36.656279 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: BEGIN
[0m17:22:36.657279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:37.172331 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:22:37.173328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:22:37.174328 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */

  create view "adventureworks2022"."public"."agg_sales_summary__dbt_tmp"
    
    
  as (
    with monthly_sales as (
    select
        date_trunc('month', "OrderDate") as "Month",
        sum("TotalPrice") as "TotalRevenue",
        count(distinct "SalesOrderID") as "TotalOrders"
    from "adventureworks2022"."public"."trans_sales_orders"
    group by 1
)
select * from monthly_sales;
  );
[0m17:22:37.226262 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from monthly_sales;
                                    ^

[0m17:22:37.227364 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: ROLLBACK
[0m17:22:37.278447 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (execute): 17:22:36.648747 => 17:22:37.277486
[0m17:22:37.278447 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: Close
[0m17:22:37.292477 [debug] [Thread-1 (]: Database Error in model agg_sales_summary (models\transform\agg_sales_summary.sql)
  syntax error at or near ";"
  LINE 15: select * from monthly_sales;
                                      ^
  compiled Code at target\run\dbt_etl_adw\models\transform\agg_sales_summary.sql
[0m17:22:37.293479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AC03D910>]}
[0m17:22:37.293479 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.agg_sales_summary .................. [[31mERROR[0m in 0.65s]
[0m17:22:37.295477 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:22:37.295477 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:22:37.297476 [info ] [Thread-1 (]: 5 of 5 START sql view model public.fact_sales .................................. [RUN]
[0m17:22:37.297476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.agg_sales_summary, now model.dbt_etl_adw.fact_sales)
[0m17:22:37.298499 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.fact_sales
[0m17:22:37.302499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.fact_sales"
[0m17:22:37.303477 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (compile): 17:22:37.298499 => 17:22:37.303477
[0m17:22:37.304479 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.fact_sales
[0m17:22:37.384552 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.fact_sales"
[0m17:22:37.386533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:22:37.386533 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: BEGIN
[0m17:22:37.387534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:22:37.892954 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:22:37.892954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:22:37.893955 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */

  create view "adventureworks2022"."public"."fact_sales__dbt_tmp"
    
    
  as (
    with fact_sales as (
    select
        SalesOrderID,
        CustomerID,
        sum(TotalPrice) as order_total
    from "adventureworks2022"."public"."trans_sales_orders"
    group by order_id, customer_id
)
select * from fact_sales;
  );
[0m17:22:37.946316 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from fact_sales;
                                 ^

[0m17:22:37.947387 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: ROLLBACK
[0m17:22:38.001160 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (execute): 17:22:37.304987 => 17:22:38.000132
[0m17:22:38.002154 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: Close
[0m17:22:38.009148 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  syntax error at or near ";"
  LINE 15: select * from fact_sales;
                                   ^
  compiled Code at target\run\dbt_etl_adw\models\marts\fact_sales.sql
[0m17:22:38.010149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9115a923-a39a-4bbb-a740-9525a1e64f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABC80DD0>]}
[0m17:22:38.011150 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model public.fact_sales ......................... [[31mERROR[0m in 0.71s]
[0m17:22:38.012059 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:22:38.014543 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:38.014543 [debug] [MainThread]: On master: BEGIN
[0m17:22:38.015551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:38.621437 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:22:38.621437 [debug] [MainThread]: On master: COMMIT
[0m17:22:38.622431 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:38.623424 [debug] [MainThread]: On master: COMMIT
[0m17:22:38.684793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:22:38.685834 [debug] [MainThread]: On master: Close
[0m17:22:38.688819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:38.688819 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:22:38.689818 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:22:38.690819 [debug] [MainThread]: Connection 'model.dbt_etl_adw.fact_sales' was properly closed.
[0m17:22:38.690819 [info ] [MainThread]: 
[0m17:22:38.691823 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m17:22:38.693813 [debug] [MainThread]: Command end result
[0m17:22:38.701869 [info ] [MainThread]: 
[0m17:22:38.703849 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:22:38.704822 [info ] [MainThread]: 
[0m17:22:38.705835 [error] [MainThread]:   Database Error in model agg_sales_summary (models\transform\agg_sales_summary.sql)
  syntax error at or near ";"
  LINE 15: select * from monthly_sales;
                                      ^
  compiled Code at target\run\dbt_etl_adw\models\transform\agg_sales_summary.sql
[0m17:22:38.706855 [info ] [MainThread]: 
[0m17:22:38.707831 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  syntax error at or near ";"
  LINE 15: select * from fact_sales;
                                   ^
  compiled Code at target\run\dbt_etl_adw\models\marts\fact_sales.sql
[0m17:22:38.708832 [info ] [MainThread]: 
[0m17:22:38.709830 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m17:22:38.713968 [debug] [MainThread]: Command `dbt run` failed at 17:22:38.713082 after 7.90 seconds
[0m17:22:38.715055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A4D51790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203ABBA9F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203AAED39D0>]}
[0m17:22:38.715055 [debug] [MainThread]: Flushing usage events
[0m17:26:11.985173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689D0B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689D1F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689D1FAD0>]}


============================== 17:26:11.990077 | b0955275-af72-46c7-906e-ee7346dfdcb5 ==============================
[0m17:26:11.990077 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:26:11.991072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models agg_sales_summary', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:26:12.213264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0955275-af72-46c7-906e-ee7346dfdcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689D77850>]}
[0m17:26:12.297385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0955275-af72-46c7-906e-ee7346dfdcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689D0AD50>]}
[0m17:26:12.299395 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:26:12.307450 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:26:12.386971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:12.386971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:12.393199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0955275-af72-46c7-906e-ee7346dfdcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68A0AC690>]}
[0m17:26:12.408721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0955275-af72-46c7-906e-ee7346dfdcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689E6D710>]}
[0m17:26:12.409710 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:26:12.411620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0955275-af72-46c7-906e-ee7346dfdcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A689D8BDD0>]}
[0m17:26:12.413706 [info ] [MainThread]: 
[0m17:26:12.415820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:26:12.416782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:26:12.434218 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:26:12.435215 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:26:12.436220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:13.034292 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:26:13.036292 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:26:13.051854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:26:13.064241 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:26:13.064241 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:26:13.065615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:13.634954 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:26:13.637070 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:26:13.638059 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:26:13.803292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:26:13.805194 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:26:13.857470 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:26:13.864007 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:13.864007 [debug] [MainThread]: On master: BEGIN
[0m17:26:13.865011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:26:14.745169 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:26:14.746159 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:14.748158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:26:14.886725 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:26:14.889803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0955275-af72-46c7-906e-ee7346dfdcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68A0AE850>]}
[0m17:26:14.889803 [debug] [MainThread]: On master: ROLLBACK
[0m17:26:14.957731 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:14.957731 [debug] [MainThread]: On master: BEGIN
[0m17:26:15.235616 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:26:15.235616 [debug] [MainThread]: On master: COMMIT
[0m17:26:15.236617 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:15.236617 [debug] [MainThread]: On master: COMMIT
[0m17:26:15.305074 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:26:15.305074 [debug] [MainThread]: On master: Close
[0m17:26:15.306591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:15.307117 [info ] [MainThread]: 
[0m17:26:15.312129 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:26:15.313510 [info ] [Thread-1 (]: 1 of 1 START sql view model public.agg_sales_summary ........................... [RUN]
[0m17:26:15.314552 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.agg_sales_summary'
[0m17:26:15.315593 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.agg_sales_summary
[0m17:26:15.321842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:26:15.323256 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (compile): 17:26:15.315593 => 17:26:15.323256
[0m17:26:15.324759 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.agg_sales_summary
[0m17:26:15.367622 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:26:15.368624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:26:15.368624 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: BEGIN
[0m17:26:15.369878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:16.195600 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:26:16.196671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:26:16.197597 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */

  create view "adventureworks2022"."public"."agg_sales_summary__dbt_tmp"
    
    
  as (
    with monthly_sales as (
    select
        date_trunc('month', "OrderDate") as "Month",
        sum("TotalPrice") as "TotalRevenue",
        count(distinct "SalesOrderID") as "TotalOrders"
    from "adventureworks2022"."public"."trans_sales_orders"
    group by 1
)
select * from monthly_sales;
  );
[0m17:26:16.258754 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from monthly_sales;
                                    ^

[0m17:26:16.259752 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: ROLLBACK
[0m17:26:16.320305 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (execute): 17:26:15.324759 => 17:26:16.320305
[0m17:26:16.321338 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: Close
[0m17:26:16.327379 [debug] [Thread-1 (]: Database Error in model agg_sales_summary (models\transform\agg_sales_summary.sql)
  syntax error at or near ";"
  LINE 15: select * from monthly_sales;
                                      ^
  compiled Code at target\run\dbt_etl_adw\models\transform\agg_sales_summary.sql
[0m17:26:16.328300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0955275-af72-46c7-906e-ee7346dfdcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A68A048F50>]}
[0m17:26:16.329388 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.agg_sales_summary .................. [[31mERROR[0m in 1.01s]
[0m17:26:16.330315 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:26:16.332870 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:16.332870 [debug] [MainThread]: On master: BEGIN
[0m17:26:16.333910 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:26:16.903678 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:26:16.904767 [debug] [MainThread]: On master: COMMIT
[0m17:26:16.905670 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:16.906682 [debug] [MainThread]: On master: COMMIT
[0m17:26:16.966388 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:26:16.967395 [debug] [MainThread]: On master: Close
[0m17:26:16.969305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:16.970385 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:26:16.971301 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:26:16.971301 [debug] [MainThread]: Connection 'model.dbt_etl_adw.agg_sales_summary' was properly closed.
[0m17:26:16.972421 [info ] [MainThread]: 
[0m17:26:16.973301 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m17:26:16.974514 [debug] [MainThread]: Command end result
[0m17:26:16.982867 [info ] [MainThread]: 
[0m17:26:16.984868 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:16.985867 [info ] [MainThread]: 
[0m17:26:16.986882 [error] [MainThread]:   Database Error in model agg_sales_summary (models\transform\agg_sales_summary.sql)
  syntax error at or near ";"
  LINE 15: select * from monthly_sales;
                                      ^
  compiled Code at target\run\dbt_etl_adw\models\transform\agg_sales_summary.sql
[0m17:26:16.987908 [info ] [MainThread]: 
[0m17:26:16.988872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:26:16.991946 [debug] [MainThread]: Command `dbt run` failed at 17:26:16.990870 after 5.08 seconds
[0m17:26:16.991946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A682F117D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687239D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6831F8450>]}
[0m17:26:16.992955 [debug] [MainThread]: Flushing usage events
[0m17:36:19.546706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A78F8FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A794B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A6258310>]}


============================== 17:36:19.553327 | f6ac9eaa-16fe-4b28-9efb-d09f93caa07a ==============================
[0m17:36:19.553327 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:36:19.555322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models agg_sales_summary', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:36:19.821379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6ac9eaa-16fe-4b28-9efb-d09f93caa07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A7A87F10>]}
[0m17:36:19.897884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6ac9eaa-16fe-4b28-9efb-d09f93caa07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A78FB350>]}
[0m17:36:19.899802 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:36:19.910308 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:36:20.004877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:20.005872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:20.011880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6ac9eaa-16fe-4b28-9efb-d09f93caa07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A7BDB990>]}
[0m17:36:20.027975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6ac9eaa-16fe-4b28-9efb-d09f93caa07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A7A5DB10>]}
[0m17:36:20.027975 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:36:20.029962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ac9eaa-16fe-4b28-9efb-d09f93caa07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A7BB77D0>]}
[0m17:36:20.032053 [info ] [MainThread]: 
[0m17:36:20.033966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:36:20.035981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:36:20.046982 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:36:20.046982 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:36:20.047974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:20.761797 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:36:20.762795 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:36:20.766846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:36:20.772899 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:36:20.772899 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:36:20.773804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:21.464070 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:36:21.465079 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:36:21.466078 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:36:21.542663 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:36:21.543663 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:36:21.615821 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:36:21.623026 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:21.623026 [debug] [MainThread]: On master: BEGIN
[0m17:36:21.623026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:22.230585 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:36:22.231571 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:22.231571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:36:22.297968 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:36:22.299970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ac9eaa-16fe-4b28-9efb-d09f93caa07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A7BDB9D0>]}
[0m17:36:22.300968 [debug] [MainThread]: On master: ROLLBACK
[0m17:36:22.361379 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:22.362375 [debug] [MainThread]: On master: BEGIN
[0m17:36:22.485346 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:36:22.486401 [debug] [MainThread]: On master: COMMIT
[0m17:36:22.487391 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:22.487391 [debug] [MainThread]: On master: COMMIT
[0m17:36:22.548984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:36:22.550012 [debug] [MainThread]: On master: Close
[0m17:36:22.551898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:22.552898 [info ] [MainThread]: 
[0m17:36:22.560082 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:36:22.560082 [info ] [Thread-1 (]: 1 of 1 START sql view model public.agg_sales_summary ........................... [RUN]
[0m17:36:22.562086 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.agg_sales_summary'
[0m17:36:22.563083 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.agg_sales_summary
[0m17:36:22.571500 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:36:22.575888 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (compile): 17:36:22.563083 => 17:36:22.574500
[0m17:36:22.577949 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.agg_sales_summary
[0m17:36:22.637154 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:36:22.639157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:36:22.640635 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: BEGIN
[0m17:36:22.641643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:36:23.293303 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:36:23.294323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:36:23.295303 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */

  create view "adventureworks2022"."public"."agg_sales_summary__dbt_tmp"
    
    
  as (
    with monthly_sales as (
    select
        date_trunc('month', "OrderDate") as "Month",
        sum("TotalPrice") as "TotalRevenue",
        count(distinct "SalesOrderID") as "TotalOrders"
    from "adventureworks2022"."public"."trans_sales_orders"
    group by 1
)
select * from monthly_sales;
  );
[0m17:36:23.363613 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from monthly_sales;
                                    ^

[0m17:36:23.364669 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: ROLLBACK
[0m17:36:23.433977 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (execute): 17:36:22.577949 => 17:36:23.432971
[0m17:36:23.433977 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: Close
[0m17:36:23.443986 [debug] [Thread-1 (]: Database Error in model agg_sales_summary (models\transform\agg_sales_summary.sql)
  syntax error at or near ";"
  LINE 15: select * from monthly_sales;
                                      ^
  compiled Code at target\run\dbt_etl_adw\models\transform\agg_sales_summary.sql
[0m17:36:23.444984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6ac9eaa-16fe-4b28-9efb-d09f93caa07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A7C50190>]}
[0m17:36:23.445985 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.agg_sales_summary .................. [[31mERROR[0m in 0.88s]
[0m17:36:23.446980 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:36:23.448983 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:23.449983 [debug] [MainThread]: On master: BEGIN
[0m17:36:23.449983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:23.972237 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:36:23.973141 [debug] [MainThread]: On master: COMMIT
[0m17:36:23.974390 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:23.974390 [debug] [MainThread]: On master: COMMIT
[0m17:36:24.027508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:36:24.028509 [debug] [MainThread]: On master: Close
[0m17:36:24.030508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:24.031589 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:36:24.032512 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:36:24.032512 [debug] [MainThread]: Connection 'model.dbt_etl_adw.agg_sales_summary' was properly closed.
[0m17:36:24.033508 [info ] [MainThread]: 
[0m17:36:24.034509 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m17:36:24.035508 [debug] [MainThread]: Command end result
[0m17:36:24.044530 [info ] [MainThread]: 
[0m17:36:24.045518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:36:24.046680 [info ] [MainThread]: 
[0m17:36:24.047687 [error] [MainThread]:   Database Error in model agg_sales_summary (models\transform\agg_sales_summary.sql)
  syntax error at or near ";"
  LINE 15: select * from monthly_sales;
                                      ^
  compiled Code at target\run\dbt_etl_adw\models\transform\agg_sales_summary.sql
[0m17:36:24.048690 [info ] [MainThread]: 
[0m17:36:24.050689 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:36:24.052692 [debug] [MainThread]: Command `dbt run` failed at 17:36:24.051688 after 4.57 seconds
[0m17:36:24.052692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A79674D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A0B017D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241A0DEB950>]}
[0m17:36:24.053900 [debug] [MainThread]: Flushing usage events
[0m17:37:23.760879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012026278D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001202627AF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001202627AC10>]}


============================== 17:37:23.765835 | 8035dedd-21aa-4219-8231-3d4e0fad9d4b ==============================
[0m17:37:23.765835 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:37:23.766832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models agg_sales_summary', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:37:23.980043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8035dedd-21aa-4219-8231-3d4e0fad9d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001202645AB90>]}
[0m17:37:24.059574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8035dedd-21aa-4219-8231-3d4e0fad9d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120263C7310>]}
[0m17:37:24.061574 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:37:24.070662 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:37:24.144767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:24.145749 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m17:37:24.284566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8035dedd-21aa-4219-8231-3d4e0fad9d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120266D5A90>]}
[0m17:37:24.296112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8035dedd-21aa-4219-8231-3d4e0fad9d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012026805550>]}
[0m17:37:24.296112 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:37:24.297159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8035dedd-21aa-4219-8231-3d4e0fad9d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120264FAE10>]}
[0m17:37:24.299202 [info ] [MainThread]: 
[0m17:37:24.301219 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:37:24.303148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:37:24.311197 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:37:24.311197 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:37:24.312184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:24.894601 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:37:24.898530 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:37:24.903447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:37:24.914519 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:37:24.914519 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:37:24.915443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:25.471772 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:37:25.473873 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:37:25.474878 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:37:25.538677 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:37:25.543663 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:37:25.603332 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:37:25.616439 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:25.616439 [debug] [MainThread]: On master: BEGIN
[0m17:37:25.617433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:26.195070 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:37:26.196077 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:26.198069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:37:26.261668 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:37:26.266054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8035dedd-21aa-4219-8231-3d4e0fad9d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012026787550>]}
[0m17:37:26.266054 [debug] [MainThread]: On master: ROLLBACK
[0m17:37:26.325655 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:26.326732 [debug] [MainThread]: On master: BEGIN
[0m17:37:26.443694 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:26.445713 [debug] [MainThread]: On master: COMMIT
[0m17:37:26.446803 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:26.447725 [debug] [MainThread]: On master: COMMIT
[0m17:37:26.507396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:26.509340 [debug] [MainThread]: On master: Close
[0m17:37:26.512257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:26.512257 [info ] [MainThread]: 
[0m17:37:26.520002 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:37:26.521014 [info ] [Thread-1 (]: 1 of 1 START sql view model public.agg_sales_summary ........................... [RUN]
[0m17:37:26.523010 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.agg_sales_summary'
[0m17:37:26.524012 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.agg_sales_summary
[0m17:37:26.532324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:37:26.533902 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (compile): 17:37:26.524012 => 17:37:26.533318
[0m17:37:26.533902 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.agg_sales_summary
[0m17:37:26.572711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:37:26.574221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:37:26.574221 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: BEGIN
[0m17:37:26.575302 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:37:27.070465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:37:27.072153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:37:27.073150 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */

  create view "adventureworks2022"."public"."agg_sales_summary__dbt_tmp"
    
    
  as (
    with monthly_sales as (
    select SUM("OrderQty" * "UnitPrice") AS "TotalRevenue"
    from public.trans_sales_orders
)
select * from monthly_sales
  );
[0m17:37:27.130549 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:27.140610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:37:27.140610 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */
alter table "adventureworks2022"."public"."agg_sales_summary__dbt_tmp" rename to "agg_sales_summary"
[0m17:37:27.194412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:27.209575 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: COMMIT
[0m17:37:27.211081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:37:27.213169 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: COMMIT
[0m17:37:27.265465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:37:27.276951 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."agg_sales_summary__dbt_backup"
[0m17:37:27.283240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:37:27.283830 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */
drop view if exists "adventureworks2022"."public"."agg_sales_summary__dbt_backup" cascade
[0m17:37:27.335644 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:27.339329 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (execute): 17:37:26.533902 => 17:37:27.339329
[0m17:37:27.340372 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: Close
[0m17:37:27.341422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8035dedd-21aa-4219-8231-3d4e0fad9d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120267ED850>]}
[0m17:37:27.342339 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.agg_sales_summary ...................... [[32mCREATE VIEW[0m in 0.82s]
[0m17:37:27.343745 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:37:27.345774 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:27.346775 [debug] [MainThread]: On master: BEGIN
[0m17:37:27.346775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:27.936160 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:37:27.938289 [debug] [MainThread]: On master: COMMIT
[0m17:37:27.940253 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:27.941282 [debug] [MainThread]: On master: COMMIT
[0m17:37:28.003648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:28.005750 [debug] [MainThread]: On master: Close
[0m17:37:28.007743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:28.008730 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:37:28.008730 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:37:28.009661 [debug] [MainThread]: Connection 'model.dbt_etl_adw.agg_sales_summary' was properly closed.
[0m17:37:28.010665 [info ] [MainThread]: 
[0m17:37:28.011676 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m17:37:28.012659 [debug] [MainThread]: Command end result
[0m17:37:28.021654 [info ] [MainThread]: 
[0m17:37:28.023655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:28.024656 [info ] [MainThread]: 
[0m17:37:28.025652 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:37:28.027758 [debug] [MainThread]: Command `dbt run` succeeded at 17:37:28.026654 after 4.33 seconds
[0m17:37:28.027758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201F5017D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012025D649D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201F7EB890>]}
[0m17:37:28.028654 [debug] [MainThread]: Flushing usage events
[0m17:44:24.313152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDDEA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDDEAB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDDE8CD0>]}


============================== 17:44:24.317200 | 8b9fdf49-25b1-4c13-a637-a41dccc22db7 ==============================
[0m17:44:24.317200 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:44:24.319211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m17:44:24.527569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9fdf49-25b1-4c13-a637-a41dccc22db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDDE9090>]}
[0m17:44:24.614559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b9fdf49-25b1-4c13-a637-a41dccc22db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDE294D0>]}
[0m17:44:24.617560 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:44:24.628785 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:44:24.707717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:24.708718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:24.714706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b9fdf49-25b1-4c13-a637-a41dccc22db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDE086BD0>]}
[0m17:44:24.728208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b9fdf49-25b1-4c13-a637-a41dccc22db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDF3DF50>]}
[0m17:44:24.729208 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:44:24.731213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9fdf49-25b1-4c13-a637-a41dccc22db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDF63090>]}
[0m17:44:24.733211 [info ] [MainThread]: 
[0m17:44:24.734212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:24.736211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:44:24.745209 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:44:24.746211 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:44:24.747209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:25.589657 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:44:25.591664 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:44:25.594663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:44:25.599658 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:44:25.600660 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:44:25.601660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:26.294244 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:44:26.296357 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:44:26.297341 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:44:26.377999 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:44:26.383022 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:44:26.456794 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:44:26.471907 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:26.471907 [debug] [MainThread]: On master: BEGIN
[0m17:44:26.472900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:27.073075 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:44:27.074153 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:27.075069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:27.142187 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m17:44:27.148260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9fdf49-25b1-4c13-a637-a41dccc22db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDE1AFCD0>]}
[0m17:44:27.149272 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:27.211454 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:27.212472 [debug] [MainThread]: On master: BEGIN
[0m17:44:27.336587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:27.336587 [debug] [MainThread]: On master: COMMIT
[0m17:44:27.337587 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:27.337587 [debug] [MainThread]: On master: COMMIT
[0m17:44:27.400587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:27.400587 [debug] [MainThread]: On master: Close
[0m17:44:27.401588 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:27.402585 [info ] [MainThread]: 
[0m17:44:27.407087 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:44:27.408078 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_sales .................................. [RUN]
[0m17:44:27.410080 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.fact_sales'
[0m17:44:27.410080 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.fact_sales
[0m17:44:27.417669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.fact_sales"
[0m17:44:27.419591 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (compile): 17:44:27.411079 => 17:44:27.418670
[0m17:44:27.419591 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.fact_sales
[0m17:44:27.460197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.fact_sales"
[0m17:44:27.462114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:44:27.463113 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: BEGIN
[0m17:44:27.465170 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:44:28.123701 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:44:28.124708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:44:28.125705 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */

  create view "adventureworks2022"."public"."fact_sales__dbt_tmp"
    
    
  as (
    with fact_sales as (
    select
        SalesOrderID,
        CustomerID,
        sum(TotalPrice) as order_total
    from "adventureworks2022"."public"."trans_sales_orders"
    group by order_id, customer_id
)
select * from fact_sales;
  );
[0m17:44:28.195305 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from fact_sales;
                                 ^

[0m17:44:28.196301 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: ROLLBACK
[0m17:44:28.265369 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (execute): 17:44:27.420587 => 17:44:28.264429
[0m17:44:28.265369 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: Close
[0m17:44:28.269276 [debug] [Thread-1 (]: Database Error in model fact_sales (models\marts\fact_sales.sql)
  syntax error at or near ";"
  LINE 15: select * from fact_sales;
                                   ^
  compiled Code at target\run\dbt_etl_adw\models\marts\fact_sales.sql
[0m17:44:28.270351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9fdf49-25b1-4c13-a637-a41dccc22db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDF9BC90>]}
[0m17:44:28.271350 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_sales ......................... [[31mERROR[0m in 0.86s]
[0m17:44:28.272287 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:44:28.274313 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:28.275345 [debug] [MainThread]: On master: BEGIN
[0m17:44:28.275345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:28.914222 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:44:28.915238 [debug] [MainThread]: On master: COMMIT
[0m17:44:28.916239 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:28.917236 [debug] [MainThread]: On master: COMMIT
[0m17:44:28.983081 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:28.984085 [debug] [MainThread]: On master: Close
[0m17:44:28.985086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:28.986082 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:44:28.986082 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:44:28.986082 [debug] [MainThread]: Connection 'model.dbt_etl_adw.fact_sales' was properly closed.
[0m17:44:28.987087 [info ] [MainThread]: 
[0m17:44:28.988082 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m17:44:28.990082 [debug] [MainThread]: Command end result
[0m17:44:28.999684 [info ] [MainThread]: 
[0m17:44:29.000694 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:44:29.002037 [info ] [MainThread]: 
[0m17:44:29.003466 [error] [MainThread]:   Database Error in model fact_sales (models\marts\fact_sales.sql)
  syntax error at or near ";"
  LINE 15: select * from fact_sales;
                                   ^
  compiled Code at target\run\dbt_etl_adw\models\marts\fact_sales.sql
[0m17:44:29.004704 [info ] [MainThread]: 
[0m17:44:29.006076 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:44:29.007483 [debug] [MainThread]: Command `dbt run` failed at 17:44:29.007483 after 4.77 seconds
[0m17:44:29.008844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD7071890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFD735B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFDDF3C690>]}
[0m17:44:29.009750 [debug] [MainThread]: Flushing usage events
[0m17:45:05.599610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B7EC9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B7ECABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B7ECB190>]}


============================== 17:45:05.603667 | 682f3d87-3e7c-4cd0-9539-ddf73ac03927 ==============================
[0m17:45:05.603667 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:45:05.606184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models fact_sales', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:05.802215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '682f3d87-3e7c-4cd0-9539-ddf73ac03927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B8064850>]}
[0m17:45:05.891946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '682f3d87-3e7c-4cd0-9539-ddf73ac03927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B80D1B50>]}
[0m17:45:05.893994 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:45:05.906796 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:45:05.990081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:05.991089 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\marts\fact_sales.sql
[0m17:45:06.120702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '682f3d87-3e7c-4cd0-9539-ddf73ac03927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B8191490>]}
[0m17:45:06.132768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '682f3d87-3e7c-4cd0-9539-ddf73ac03927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B82881D0>]}
[0m17:45:06.133723 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:45:06.134704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '682f3d87-3e7c-4cd0-9539-ddf73ac03927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B80F4AD0>]}
[0m17:45:06.136706 [info ] [MainThread]: 
[0m17:45:06.137707 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:06.139703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:45:06.148713 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:45:06.148713 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:45:06.149719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:06.834575 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:45:06.836560 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:45:06.839598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:45:06.844679 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:45:06.844679 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:45:06.845594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:07.431509 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:45:07.432489 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:45:07.434424 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:45:07.498670 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:45:07.501620 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:45:07.560801 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:45:07.569883 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:07.569883 [debug] [MainThread]: On master: BEGIN
[0m17:45:07.570985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:08.132329 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:45:08.132329 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:08.133410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:08.196882 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m17:45:08.200871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '682f3d87-3e7c-4cd0-9539-ddf73ac03927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B8327050>]}
[0m17:45:08.201876 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:08.261117 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:08.262116 [debug] [MainThread]: On master: BEGIN
[0m17:45:08.379229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:08.380232 [debug] [MainThread]: On master: COMMIT
[0m17:45:08.382230 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:08.382230 [debug] [MainThread]: On master: COMMIT
[0m17:45:08.441832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:08.442769 [debug] [MainThread]: On master: Close
[0m17:45:08.443767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:08.444767 [info ] [MainThread]: 
[0m17:45:08.449767 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:45:08.450768 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_sales .................................. [RUN]
[0m17:45:08.452769 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.fact_sales'
[0m17:45:08.452769 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.fact_sales
[0m17:45:08.459854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.fact_sales"
[0m17:45:08.461767 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (compile): 17:45:08.453766 => 17:45:08.460845
[0m17:45:08.462764 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.fact_sales
[0m17:45:08.507305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.fact_sales"
[0m17:45:08.508306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:45:08.509212 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: BEGIN
[0m17:45:08.510211 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:09.131897 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:45:09.133980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:45:09.134996 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */

  create view "adventureworks2022"."public"."fact_sales__dbt_tmp"
    
    
  as (
    with fact_sales as (
    select "SalesOrderID",
        "CustomerID",
        SUM("OrderQty" * "UnitPrice") AS "TotalRevenue"
    from public.trans_sales_orders
    group by "SalesOrderID", "CustomerID"
)
select * from fact_sales
  );
[0m17:45:09.210637 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:09.222650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:45:09.222650 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */
alter table "adventureworks2022"."public"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m17:45:09.291232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:09.304900 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: COMMIT
[0m17:45:09.305910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:45:09.306826 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: COMMIT
[0m17:45:09.373523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:09.384630 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."fact_sales__dbt_backup"
[0m17:45:09.389718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:45:09.389718 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */
drop view if exists "adventureworks2022"."public"."fact_sales__dbt_backup" cascade
[0m17:45:09.456719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:09.460817 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (execute): 17:45:08.463764 => 17:45:09.460817
[0m17:45:09.462741 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: Close
[0m17:45:09.464739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '682f3d87-3e7c-4cd0-9539-ddf73ac03927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B8440610>]}
[0m17:45:09.465735 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fact_sales ............................. [[32mCREATE VIEW[0m in 1.01s]
[0m17:45:09.466943 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:45:09.468969 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.470030 [debug] [MainThread]: On master: BEGIN
[0m17:45:09.470030 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:09.966993 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:09.969093 [debug] [MainThread]: On master: COMMIT
[0m17:45:09.970106 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.971075 [debug] [MainThread]: On master: COMMIT
[0m17:45:10.023043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:10.023043 [debug] [MainThread]: On master: Close
[0m17:45:10.025018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:10.026057 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:45:10.026057 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:45:10.026974 [debug] [MainThread]: Connection 'model.dbt_etl_adw.fact_sales' was properly closed.
[0m17:45:10.026974 [info ] [MainThread]: 
[0m17:45:10.027975 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m17:45:10.028994 [debug] [MainThread]: Command end result
[0m17:45:10.037978 [info ] [MainThread]: 
[0m17:45:10.039976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:10.040975 [info ] [MainThread]: 
[0m17:45:10.041972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:10.043974 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:10.042973 after 4.52 seconds
[0m17:45:10.043974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B10D1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B16C0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B1366710>]}
[0m17:45:10.044972 [debug] [MainThread]: Flushing usage events
[0m17:50:03.934235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B158CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909AE8B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B16F690>]}


============================== 17:50:03.939243 | 8f480554-d4bb-4cf6-9bf5-3995ac006671 ==============================
[0m17:50:03.939243 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:50:03.940242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models stg_sales_header', 'send_anonymous_usage_stats': 'True'}
[0m17:50:04.139073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f480554-d4bb-4cf6-9bf5-3995ac006671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B267110>]}
[0m17:50:04.226900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f480554-d4bb-4cf6-9bf5-3995ac006671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909A596250>]}
[0m17:50:04.228884 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:50:04.236969 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:50:04.323667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:04.323667 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_header.sql
[0m17:50:04.581172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f480554-d4bb-4cf6-9bf5-3995ac006671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B6E42D0>]}
[0m17:50:04.593879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f480554-d4bb-4cf6-9bf5-3995ac006671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B546A10>]}
[0m17:50:04.594879 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:50:04.595881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f480554-d4bb-4cf6-9bf5-3995ac006671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B5FE910>]}
[0m17:50:04.596878 [info ] [MainThread]: 
[0m17:50:04.598881 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:04.600885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:50:04.610884 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:50:04.611883 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:50:04.612880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:05.227334 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:50:05.229325 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:50:05.232493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:50:05.238490 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:50:05.238490 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:50:05.239492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:05.757881 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:50:05.759846 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:50:05.760866 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:50:05.818401 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:50:05.822472 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:50:05.876959 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:50:05.885545 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:05.885545 [debug] [MainThread]: On master: BEGIN
[0m17:50:05.886548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:06.408665 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:50:06.410780 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:06.411757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:06.473072 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m17:50:06.479084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f480554-d4bb-4cf6-9bf5-3995ac006671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B7E7ED0>]}
[0m17:50:06.480085 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:06.534747 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:06.535829 [debug] [MainThread]: On master: BEGIN
[0m17:50:06.643486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:06.645584 [debug] [MainThread]: On master: COMMIT
[0m17:50:06.646609 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:06.647508 [debug] [MainThread]: On master: COMMIT
[0m17:50:06.702324 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:06.703313 [debug] [MainThread]: On master: Close
[0m17:50:06.706310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:06.708304 [info ] [MainThread]: 
[0m17:50:06.715407 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:50:06.716373 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:50:06.719407 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:50:06.719407 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:50:06.729833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:50:06.731749 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:50:06.720466 => 17:50:06.731749
[0m17:50:06.732824 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:50:06.774840 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:50:06.775750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:50:06.775750 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:50:06.776833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:07.354404 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:50:07.356509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:50:07.358421 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from "adventureworks2022"."public"."salesorderheader"
)
select * from sales_header
  );
[0m17:50:07.421756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:50:07.433860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:50:07.434872 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:50:07.495003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:50:07.502014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:50:07.502014 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:50:07.560792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:50:07.575870 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:50:07.575870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:50:07.576855 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:50:07.636253 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:50:07.646264 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:50:07.651266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:50:07.651266 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:50:07.712662 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:50:07.716765 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:50:06.732824 => 17:50:07.716765
[0m17:50:07.717779 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:50:07.719673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f480554-d4bb-4cf6-9bf5-3995ac006671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B8ACD50>]}
[0m17:50:07.720788 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 1.00s]
[0m17:50:07.721369 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:50:07.723779 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:07.724766 [debug] [MainThread]: On master: BEGIN
[0m17:50:07.724766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:08.283770 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:50:08.285781 [debug] [MainThread]: On master: COMMIT
[0m17:50:08.286783 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:08.287779 [debug] [MainThread]: On master: COMMIT
[0m17:50:08.348261 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:08.349364 [debug] [MainThread]: On master: Close
[0m17:50:08.352336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:08.353337 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:50:08.355343 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:50:08.355343 [debug] [MainThread]: Connection 'model.dbt_etl_adw.stg_sales_header' was properly closed.
[0m17:50:08.356339 [info ] [MainThread]: 
[0m17:50:08.357472 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m17:50:08.358967 [debug] [MainThread]: Command end result
[0m17:50:08.371738 [info ] [MainThread]: 
[0m17:50:08.372741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:08.376199 [info ] [MainThread]: 
[0m17:50:08.377206 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:08.379207 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:08.379207 after 4.51 seconds
[0m17:50:08.379207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002909B16FB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290943917D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290946266D0>]}
[0m17:50:08.380589 [debug] [MainThread]: Flushing usage events
[0m17:52:18.008469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025994448E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025994458810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259944581D0>]}


============================== 17:52:18.012152 | 8a92ad0f-63e7-4dc7-8464-378f1f526364 ==============================
[0m17:52:18.012152 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:52:18.014160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Shai\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Shai\\Documents\\GitHub\\aws-1st-DE-Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:52:18.198302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025994448B10>]}
[0m17:52:18.278821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599448A750>]}
[0m17:52:18.281049 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:52:18.290060 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:52:18.406569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m17:52:18.407574 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\agg_sales_summary.sql
[0m17:52:18.407574 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\staging\stg_sales_order_detail.sql
[0m17:52:18.408571 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\transform\trans_sales_orders.sql
[0m17:52:18.408571 [debug] [MainThread]: Partial parsing: updated file: dbt_etl_adw://models\marts\fact_sales.sql
[0m17:52:18.672557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259949E0F10>]}
[0m17:52:18.685464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599473F5D0>]}
[0m17:52:18.685464 [info ] [MainThread]: Found 5 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:52:18.686457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259945C9A50>]}
[0m17:52:18.689525 [info ] [MainThread]: 
[0m17:52:18.691461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:52:18.693030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022'
[0m17:52:18.707043 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022"
[0m17:52:18.708043 [debug] [ThreadPool]: On list_adventureworks2022: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022"} */

    select distinct nspname from pg_namespace
  
[0m17:52:18.709043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:19.304079 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m17:52:19.308120 [debug] [ThreadPool]: On list_adventureworks2022: Close
[0m17:52:19.311424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_adventureworks2022_public'
[0m17:52:19.317422 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:52:19.317422 [debug] [ThreadPool]: On list_adventureworks2022_public: BEGIN
[0m17:52:19.318422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:19.928264 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m17:52:19.930241 [debug] [ThreadPool]: Using postgres connection "list_adventureworks2022_public"
[0m17:52:19.931777 [debug] [ThreadPool]: On list_adventureworks2022_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "list_adventureworks2022_public"} */
select
      'adventureworks2022' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'adventureworks2022' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:52:19.998043 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:52:20.002037 [debug] [ThreadPool]: On list_adventureworks2022_public: ROLLBACK
[0m17:52:20.064694 [debug] [ThreadPool]: On list_adventureworks2022_public: Close
[0m17:52:20.076081 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:20.077076 [debug] [MainThread]: On master: BEGIN
[0m17:52:20.077076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:20.665306 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:52:20.666690 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:20.667577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:20.735284 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m17:52:20.742917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025994AA1F10>]}
[0m17:52:20.743922 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:20.806181 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:20.808204 [debug] [MainThread]: On master: BEGIN
[0m17:52:20.931905 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:20.933402 [debug] [MainThread]: On master: COMMIT
[0m17:52:20.933402 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:20.934411 [debug] [MainThread]: On master: COMMIT
[0m17:52:20.996014 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:20.997014 [debug] [MainThread]: On master: Close
[0m17:52:20.998013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:20.998013 [info ] [MainThread]: 
[0m17:52:21.001267 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_header
[0m17:52:21.002266 [info ] [Thread-1 (]: 1 of 5 START sql view model public.stg_sales_header ............................ [RUN]
[0m17:52:21.004267 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_etl_adw.stg_sales_header'
[0m17:52:21.005267 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_header
[0m17:52:21.015272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.017270 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (compile): 17:52:21.005267 => 17:52:21.016274
[0m17:52:21.017270 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_header
[0m17:52:21.063957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.063957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.073871 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: BEGIN
[0m17:52:21.074878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:21.655369 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:52:21.656853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.657978 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */

  create view "adventureworks2022"."public"."stg_sales_header__dbt_tmp"
    
    
  as (
    with sales_header as (
    select 
        "SalesOrderID",
        "CustomerID",
        "OrderDate",
        "TotalDue"
    from "adventureworks2022"."public"."salesorderheader"
)
select * from sales_header
  );
[0m17:52:21.721378 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:21.730949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.732766 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header" rename to "stg_sales_header__dbt_backup"
[0m17:52:21.791779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:21.798526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.799548 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
alter table "adventureworks2022"."public"."stg_sales_header__dbt_tmp" rename to "stg_sales_header"
[0m17:52:21.859293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:21.878702 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:52:21.879708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.879708 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: COMMIT
[0m17:52:21.940261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:21.948784 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_header__dbt_backup"
[0m17:52:21.953295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_header"
[0m17:52:21.954295 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_header"} */
drop view if exists "adventureworks2022"."public"."stg_sales_header__dbt_backup" cascade
[0m17:52:22.013475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:22.015991 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_header (execute): 17:52:21.018270 => 17:52:22.015991
[0m17:52:22.017072 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_header: Close
[0m17:52:22.017990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025994AB1D10>]}
[0m17:52:22.019027 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.stg_sales_header ....................... [[32mCREATE VIEW[0m in 1.01s]
[0m17:52:22.020538 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_header
[0m17:52:22.021553 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:52:22.022577 [info ] [Thread-1 (]: 2 of 5 START sql view model public.stg_sales_order_detail ...................... [RUN]
[0m17:52:22.023548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_header, now model.dbt_etl_adw.stg_sales_order_detail)
[0m17:52:22.024640 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.stg_sales_order_detail
[0m17:52:22.028199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.030116 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (compile): 17:52:22.024640 => 17:52:22.029114
[0m17:52:22.030116 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.stg_sales_order_detail
[0m17:52:22.035725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.039261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.040256 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: BEGIN
[0m17:52:22.041304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:22.526324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:22.528445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.530359 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */

  create view "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp"
    
    
  as (
    with sales_order_detail as (
    select 
        "SalesOrderID",
        "SalesOrderDetailID",
        "ProductID",
        "OrderQty",
        "UnitPrice",
        "OrderQty" * "UnitPrice" as "TotalPrice"
    from "adventureworks2022"."public"."salesorderdetail"
)
select * from sales_order_detail
  );
[0m17:52:22.587914 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:22.598953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.599911 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m17:52:22.653482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:22.661572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.662595 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
alter table "adventureworks2022"."public"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m17:52:22.716072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:22.725016 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:52:22.726023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.729031 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: COMMIT
[0m17:52:22.782315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:22.784323 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup"
[0m17:52:22.785322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.stg_sales_order_detail"
[0m17:52:22.786321 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.stg_sales_order_detail"} */
drop view if exists "adventureworks2022"."public"."stg_sales_order_detail__dbt_backup" cascade
[0m17:52:22.838724 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:22.840725 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.stg_sales_order_detail (execute): 17:52:22.030116 => 17:52:22.839725
[0m17:52:22.840725 [debug] [Thread-1 (]: On model.dbt_etl_adw.stg_sales_order_detail: Close
[0m17:52:22.841729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025994BDDD10>]}
[0m17:52:22.843140 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.stg_sales_order_detail ................. [[32mCREATE VIEW[0m in 0.82s]
[0m17:52:22.844472 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.stg_sales_order_detail
[0m17:52:22.845481 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.trans_sales_orders
[0m17:52:22.846479 [info ] [Thread-1 (]: 3 of 5 START sql view model public.trans_sales_orders .......................... [RUN]
[0m17:52:22.847777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.stg_sales_order_detail, now model.dbt_etl_adw.trans_sales_orders)
[0m17:52:22.847777 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.trans_sales_orders
[0m17:52:22.851287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:22.853295 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (compile): 17:52:22.848782 => 17:52:22.852295
[0m17:52:22.854294 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.trans_sales_orders
[0m17:52:22.861763 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:22.862765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:22.863765 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: BEGIN
[0m17:52:22.864765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:23.403746 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:52:23.405307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:23.406994 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */

  create view "adventureworks2022"."public"."trans_sales_orders__dbt_tmp"
    
    
  as (
    with combined as (
    select sh."SalesOrderID",
        sh."CustomerID",
        sh."OrderDate",
        sh."TotalDue",
        sd."ProductID",
        sd."OrderQty",
        sd."UnitPrice"
    from "adventureworks2022"."public"."stg_sales_header" as sh
    join "adventureworks2022"."public"."stg_sales_order_detail" as sd
    on sh."SalesOrderID" = sd."SalesOrderID"
)
select * from combined
  );
[0m17:52:23.461691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:23.470794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:23.471704 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */
alter table "adventureworks2022"."public"."trans_sales_orders" rename to "trans_sales_orders__dbt_backup"
[0m17:52:23.524025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:23.532035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:23.533038 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */
alter table "adventureworks2022"."public"."trans_sales_orders__dbt_tmp" rename to "trans_sales_orders"
[0m17:52:23.584782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:23.586781 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: COMMIT
[0m17:52:23.586781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:23.587784 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: COMMIT
[0m17:52:23.640161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:23.643342 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."trans_sales_orders__dbt_backup"
[0m17:52:23.644349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.trans_sales_orders"
[0m17:52:23.645347 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.trans_sales_orders"} */
drop view if exists "adventureworks2022"."public"."trans_sales_orders__dbt_backup" cascade
[0m17:52:23.699329 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:23.700329 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.trans_sales_orders (execute): 17:52:22.854294 => 17:52:23.700329
[0m17:52:23.701329 [debug] [Thread-1 (]: On model.dbt_etl_adw.trans_sales_orders: Close
[0m17:52:23.702331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259949473D0>]}
[0m17:52:23.703328 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.trans_sales_orders ..................... [[32mCREATE VIEW[0m in 0.86s]
[0m17:52:23.703682 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.trans_sales_orders
[0m17:52:23.704699 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.agg_sales_summary
[0m17:52:23.705720 [info ] [Thread-1 (]: 4 of 5 START sql view model public.agg_sales_summary ........................... [RUN]
[0m17:52:23.706694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.trans_sales_orders, now model.dbt_etl_adw.agg_sales_summary)
[0m17:52:23.706694 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.agg_sales_summary
[0m17:52:23.709710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:52:23.710693 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (compile): 17:52:23.706694 => 17:52:23.710693
[0m17:52:23.710693 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.agg_sales_summary
[0m17:52:23.715697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.agg_sales_summary"
[0m17:52:23.717697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:52:23.717697 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: BEGIN
[0m17:52:23.718694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:24.223126 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:52:24.224336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:52:24.224336 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */

  create view "adventureworks2022"."public"."agg_sales_summary__dbt_tmp"
    
    
  as (
    with monthly_sales as (
    select SUM("OrderQty" * "UnitPrice") AS "TotalRevenue"
    from "adventureworks2022"."public"."trans_sales_orders"
)
select * from monthly_sales
  );
[0m17:52:24.278216 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:24.325227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:52:24.325227 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */
alter table "adventureworks2022"."public"."agg_sales_summary__dbt_tmp" rename to "agg_sales_summary"
[0m17:52:24.378261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:24.382253 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: COMMIT
[0m17:52:24.383254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:52:24.383254 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: COMMIT
[0m17:52:24.436397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:24.444510 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."agg_sales_summary__dbt_backup"
[0m17:52:24.445409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.agg_sales_summary"
[0m17:52:24.446500 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.agg_sales_summary"} */
drop view if exists "adventureworks2022"."public"."agg_sales_summary__dbt_backup" cascade
[0m17:52:24.498630 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:24.502701 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.agg_sales_summary (execute): 17:52:23.711713 => 17:52:24.501603
[0m17:52:24.503697 [debug] [Thread-1 (]: On model.dbt_etl_adw.agg_sales_summary: Close
[0m17:52:24.504898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259911EC490>]}
[0m17:52:24.506010 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.agg_sales_summary ...................... [[32mCREATE VIEW[0m in 0.80s]
[0m17:52:24.506904 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.agg_sales_summary
[0m17:52:24.507924 [debug] [Thread-1 (]: Began running node model.dbt_etl_adw.fact_sales
[0m17:52:24.508602 [info ] [Thread-1 (]: 5 of 5 START sql view model public.fact_sales .................................. [RUN]
[0m17:52:24.509185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_etl_adw.agg_sales_summary, now model.dbt_etl_adw.fact_sales)
[0m17:52:24.510227 [debug] [Thread-1 (]: Began compiling node model.dbt_etl_adw.fact_sales
[0m17:52:24.512213 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_etl_adw.fact_sales"
[0m17:52:24.514197 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (compile): 17:52:24.510227 => 17:52:24.513213
[0m17:52:24.514197 [debug] [Thread-1 (]: Began executing node model.dbt_etl_adw.fact_sales
[0m17:52:24.519352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_etl_adw.fact_sales"
[0m17:52:24.521352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:52:24.521352 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: BEGIN
[0m17:52:24.522453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:25.119454 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m17:52:25.120455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:52:25.121455 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */

  create view "adventureworks2022"."public"."fact_sales__dbt_tmp"
    
    
  as (
    with fact_sales as (
    select "SalesOrderID",
        "CustomerID",
        SUM("OrderQty" * "UnitPrice") AS "TotalRevenue"
    from "adventureworks2022"."public"."trans_sales_orders"
    group by "SalesOrderID", "CustomerID"
)
select * from fact_sales
  );
[0m17:52:25.184458 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:25.192541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:52:25.193536 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */
alter table "adventureworks2022"."public"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m17:52:25.255614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:25.259602 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: COMMIT
[0m17:52:25.259602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:52:25.260604 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: COMMIT
[0m17:52:25.323455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:25.331451 [debug] [Thread-1 (]: Applying DROP to: "adventureworks2022"."public"."fact_sales__dbt_backup"
[0m17:52:25.334537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_etl_adw.fact_sales"
[0m17:52:25.334537 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_etl_adw", "target_name": "dev", "node_id": "model.dbt_etl_adw.fact_sales"} */
drop view if exists "adventureworks2022"."public"."fact_sales__dbt_backup" cascade
[0m17:52:25.396797 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:25.401837 [debug] [Thread-1 (]: Timing info for model.dbt_etl_adw.fact_sales (execute): 17:52:24.514197 => 17:52:25.400800
[0m17:52:25.402796 [debug] [Thread-1 (]: On model.dbt_etl_adw.fact_sales: Close
[0m17:52:25.405865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a92ad0f-63e7-4dc7-8464-378f1f526364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002599462AA50>]}
[0m17:52:25.406788 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.fact_sales ............................. [[32mCREATE VIEW[0m in 0.90s]
[0m17:52:25.408996 [debug] [Thread-1 (]: Finished running node model.dbt_etl_adw.fact_sales
[0m17:52:25.410226 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:25.411313 [debug] [MainThread]: On master: BEGIN
[0m17:52:25.411313 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:25.926902 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m17:52:25.929000 [debug] [MainThread]: On master: COMMIT
[0m17:52:25.929922 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:25.930924 [debug] [MainThread]: On master: COMMIT
[0m17:52:25.984130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:25.985239 [debug] [MainThread]: On master: Close
[0m17:52:25.988228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:25.989265 [debug] [MainThread]: Connection 'list_adventureworks2022' was properly closed.
[0m17:52:25.990242 [debug] [MainThread]: Connection 'list_adventureworks2022_public' was properly closed.
[0m17:52:25.991149 [debug] [MainThread]: Connection 'model.dbt_etl_adw.fact_sales' was properly closed.
[0m17:52:25.992241 [info ] [MainThread]: 
[0m17:52:25.993144 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m17:52:25.996981 [debug] [MainThread]: Command end result
[0m17:52:26.008978 [info ] [MainThread]: 
[0m17:52:26.010364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:26.010868 [info ] [MainThread]: 
[0m17:52:26.012874 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:52:26.014875 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:26.014875 after 8.07 seconds
[0m17:52:26.015876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002598D721790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002598DA08690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002598DA08550>]}
[0m17:52:26.016881 [debug] [MainThread]: Flushing usage events
